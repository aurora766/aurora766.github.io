<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>redis | Fomalhaut🥝</title><meta name="keywords" content="Java,MySQL,算法,代码,博客,Butterfly,Hexo,Fomalhaut🥝,Fomalhaut"><meta name="author" content="Fomalhaut🥝"><meta name="copyright" content="Fomalhaut🥝"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="1. 编写密钥分发免交互的脚本1234567891011121314151617181920212223242526272829303132333435363738#!&#x2F;bin&#x2F;bash#创建一个IP地址文件。&gt;ip.txtpass&#x3D;root#检测expect是否安装，检测公钥是否创建。rpm -q expect &amp;&gt; &#x2F;dev&#x2F;nullif [ $? -ne 0 ] ;the">
<meta property="og:type" content="article">
<meta property="og:title" content="redis">
<meta property="og:url" content="https://www.fomal.cc/posts/7b25d017.html">
<meta property="og:site_name" content="Fomalhaut🥝">
<meta property="og:description" content="1. 编写密钥分发免交互的脚本1234567891011121314151617181920212223242526272829303132333435363738#!&#x2F;bin&#x2F;bash#创建一个IP地址文件。&gt;ip.txtpass&#x3D;root#检测expect是否安装，检测公钥是否创建。rpm -q expect &amp;&gt; &#x2F;dev&#x2F;nullif [ $? -ne 0 ] ;the">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://source.fomal.cc/img/default_cover_14.webp">
<meta property="article:published_time" content="2024-09-15T08:32:21.000Z">
<meta property="article:modified_time" content="2024-09-15T08:35:50.160Z">
<meta property="article:author" content="Fomalhaut🥝">
<meta property="article:tag" content="Java,MySQL,算法,代码,博客,Butterfly,Hexo,Fomalhaut🥝,Fomalhaut">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://source.fomal.cc/img/default_cover_14.webp"><link rel="shortcut icon" href="/"><link rel="canonical" href="https://www.fomal.cc/posts/7b25d017"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'redis',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-15 16:35:50'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Fomalhaut🥝" type="application/atom+xml">
</head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2023/01/02/avatar.webp" onerror="onerror=null;src='/assets/r1.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">2</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> 八音盒</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> 影院</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> 画廊</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> 动画</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> 网站统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> 旧时光</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-qunliaotian">                   </use></svg><span class="menu_word" style="font-size:17px"> 唠叨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-love-sign">                   </use></svg><span class="menu_word" style="font-size:17px"> 恋爱小屋</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Fomalhaut🥝</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> 八音盒</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> 影院</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> 画廊</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> 动画</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> 网站统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> 旧时光</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-qunliaotian">                   </use></svg><span class="menu_word" style="font-size:17px"> 唠叨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-love-sign">                   </use></svg><span class="menu_word" style="font-size:17px"> 恋爱小屋</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> 关于</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="检索站内任何你想要的信息"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-valentine_-search-love-find-heart"></use></svg><span> 搜索</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="美化设置-自定义你的风格" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-tupian1"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="浅色和深色模式转换" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon">       </use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">redis</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">发表于 </span><time class="post-meta-date-created" datetime="2024-09-15T08:32:21.000Z" title="发表于 2024-09-15 16:32:21">2024-09-15</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-15T08:35:50.160Z" title="更新于 2024-09-15 16:35:50">2024-09-15</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">字数总计:</span><span class="word-count">1.4w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">阅读时长:</span><span>58分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="redis"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-编写密钥分发免交互的脚本"><a href="#1-编写密钥分发免交互的脚本" class="headerlink" title="1. 编写密钥分发免交互的脚本"></a>1. 编写密钥分发免交互的脚本</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#创建一个IP地址文件。</span></span><br><span class="line">&gt;ip.txt</span><br><span class="line">pass=root</span><br><span class="line"><span class="comment">#检测expect是否安装，检测公钥是否创建。</span></span><br><span class="line">rpm -q expect &amp;&gt; /dev/null</span><br><span class="line"><span class="keyword">if</span> [ $? -ne 0 ] ;<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;开始安装expect，请稍等一会...&quot;</span></span><br><span class="line">        yum install -y expect &amp;&gt; /dev/null</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;expect安装完成&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ ! -f ~/.ssh/id_rsa ];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;开始创建密钥对...&quot;</span></span><br><span class="line">        ssh-keygen -P <span class="string">&quot;&quot;</span> -f ~/.ssh/id_rsa &amp;&gt; /dev/null</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;密钥对创建完成&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">#使用for循环ping测试主机是否在线。</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;2..254&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">        ip=10.0.0.<span class="variable">$i</span></span><br><span class="line">        ping -c1 -W1 <span class="variable">$ip</span> &amp;&gt; /dev/null</span><br><span class="line">        <span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$ip</span>&quot;</span> &gt;&gt; ip.txt</span><br><span class="line">        /usr/bin/expect &lt;&lt;-<span class="string">EOF &amp;&gt; /dev/null</span></span><br><span class="line"><span class="string">set timeout 10</span></span><br><span class="line"><span class="string">spawn ssh-copy-id $ip </span></span><br><span class="line"><span class="string">expect &#123;</span></span><br><span class="line"><span class="string">        &quot;yes/no&quot; &#123; send &quot;yes\r&quot;; exp_continue &#125; &amp;&gt; /dev/null</span></span><br><span class="line"><span class="string">        &quot;password:&quot; &#123; send &quot;$pass\r&quot; &#125; &amp;&gt; /dev/null</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">expect eof &amp;&gt; /dev/null</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        &#125;&amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;推送公钥和免交互工作已完成，你现在可以直接远程登陆机器了&quot;</span></span><br></pre></td></tr></table></figure>
<p>ansible主机清单</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[lb_group]</span><br><span class="line">lb01    ansible_host=172.16.1.5</span><br><span class="line">lb02    ansible_host=172.16.1.6</span><br><span class="line"></span><br><span class="line">[web_group]</span><br><span class="line">web01   ansible_host=172.16.1.7</span><br><span class="line">web02   ansible_host=172.16.1.8</span><br><span class="line">web03   ansible_host=172.16.1.9</span><br><span class="line"></span><br><span class="line">[db_group]</span><br><span class="line">db01    ansible_host=172.16.1.51</span><br><span class="line">db02    ansible_host=172.16.1.52</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nfs          ansible_host=172.16.1.31</span><br><span class="line">backup       ansible_host=172.16.1.41</span><br><span class="line">zabbix       ansible_host=172.16.1.71</span><br><span class="line">elk          ansible_host=172.16.1.72</span><br><span class="line">jenkins      ansible_host=172.16.1.73</span><br><span class="line">Jumpserver   ansible_host=172.16.1.74</span><br></pre></td></tr></table></figure>
<h2 id="2-跳板机脚本"><a href="#2-跳板机脚本" class="headerlink" title="2. 跳板机脚本"></a>2. 跳板机脚本</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#！/bin/bash</span></span><br><span class="line"><span class="comment">#jumpserver</span></span><br><span class="line">lb01=172.16.1.5</span><br><span class="line">lb02=172.16.1.6</span><br><span class="line">web01=172.16.1.7</span><br><span class="line">web02=172.16.1.8</span><br><span class="line">web03=172.16.1.9</span><br><span class="line">db01=172.16.1.51</span><br><span class="line">db02=172.16.1.52</span><br><span class="line">nfs=172.16.1.31</span><br><span class="line">backup=172.16.1.41</span><br><span class="line">zabbix=172.16.1.71</span><br><span class="line">elk=172.16.1.72</span><br><span class="line">jenkins=172.16.1.73</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="title">menu</span></span>()&#123;</span><br><span class="line">        <span class="built_in">cat</span> &lt;&lt;-<span class="string">EOF</span></span><br><span class="line"><span class="string">        +-------------------------+</span></span><br><span class="line"><span class="string">        |     1) lb01             |</span></span><br><span class="line"><span class="string">        |     2) lb02             |</span></span><br><span class="line"><span class="string">        |     3) web01            |</span></span><br><span class="line"><span class="string">        |     4) web02            |</span></span><br><span class="line"><span class="string">        |     5) web03            |</span></span><br><span class="line"><span class="string">        |     6) db01             |</span></span><br><span class="line"><span class="string">        |     7) db02             |</span></span><br><span class="line"><span class="string">        |     8) nfs              |</span></span><br><span class="line"><span class="string">        |     9) backup           |</span></span><br><span class="line"><span class="string">        |     10) zabbix          |</span></span><br><span class="line"><span class="string">        |     11) elk             |</span></span><br><span class="line"><span class="string">        |     12) jenkins         |</span></span><br><span class="line"><span class="string">        |     h) help             |</span></span><br><span class="line"><span class="string">        +-------------------------+</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#菜单函数</span></span><br><span class="line">menu</span><br><span class="line"> </span><br><span class="line"><span class="comment">#连接函数</span></span><br><span class="line"><span class="function"><span class="title">connect</span></span>()&#123;</span><br><span class="line">  ping -c 1 -w 1 <span class="variable">$1</span> &amp;&gt;/dev/null</span><br><span class="line">  <span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">    ssh root@<span class="variable">$1</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[5;4;40;31m 别连了,我的哥,<span class="variable">$2</span>:<span class="variable">$1</span>机器都没开!!!\033[0m&quot;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#控制不让输入ctrl+c,z</span></span><br><span class="line"><span class="built_in">trap</span> <span class="string">&quot;&quot;</span> HUP INT TSTP</span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">read</span> -p <span class="string">&quot;请输入要连接的主机编号：&quot;</span> num</span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$num</span> <span class="keyword">in</span></span><br><span class="line">            1|lb01)</span><br><span class="line">              connect <span class="variable">$lb01</span> lb01</span><br><span class="line">                    ;;</span><br><span class="line">            2|lb02)</span><br><span class="line">              connect <span class="variable">$lb02</span> lb02</span><br><span class="line">                    ;;</span><br><span class="line">            3|web01)</span><br><span class="line">              connect <span class="variable">$web01</span> web01</span><br><span class="line">                    ;;</span><br><span class="line">            4|web02)</span><br><span class="line">              connect <span class="variable">$web02</span> web02</span><br><span class="line">                    ;;</span><br><span class="line">            5|web03)</span><br><span class="line">                  connect <span class="variable">$web03</span> web03</span><br><span class="line">                    ;;</span><br><span class="line">            6|db01)</span><br><span class="line">                  connect <span class="variable">$web03</span> db01</span><br><span class="line">                    ;;</span><br><span class="line">            7|db02)</span><br><span class="line">                  connect <span class="variable">$web03</span> db02</span><br><span class="line">                    ;;</span><br><span class="line">            8|nfs)</span><br><span class="line">              connect <span class="variable">$nfs</span> nfs</span><br><span class="line">                    ;;</span><br><span class="line">            9|backup)</span><br><span class="line">                  connect <span class="variable">$backup</span> backup</span><br><span class="line">                    ;;</span><br><span class="line">            10|zabbix)</span><br><span class="line">                    connect <span class="variable">$zabbix</span> zabbix</span><br><span class="line">                    ;;</span><br><span class="line">            11|elk)</span><br><span class="line">                   connect <span class="variable">$db01</span> elk</span><br><span class="line">                    ;;</span><br><span class="line">            12|jenkins)</span><br><span class="line">                    connect <span class="variable">$m01</span> jenkins</span><br><span class="line">                    ;;</span><br><span class="line">            h|<span class="built_in">help</span>)</span><br><span class="line">                    clear</span><br><span class="line">                    menu</span><br><span class="line">                    ;;</span><br><span class="line">            close)</span><br><span class="line">                    <span class="built_in">break</span></span><br><span class="line">                    ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#脚本功能：使用xtrabackupex工具做物理备份</span></span><br><span class="line"><span class="comment">#每周日：凌晨1:00做一次全备</span></span><br><span class="line"><span class="comment">#每周一~周六：每天做一次差异备份</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#备份数据存放的目录</span></span><br><span class="line">backup_dir=/backup</span><br><span class="line"></span><br><span class="line"><span class="comment">#数据库的用户名,密码</span></span><br><span class="line">name=root</span><br><span class="line">passwd=123</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取今天是周几</span></span><br><span class="line">wdate=$(<span class="built_in">date</span> +%w)</span><br><span class="line"></span><br><span class="line"><span class="comment">#差异备份函数</span></span><br><span class="line"><span class="function"><span class="title">inc</span></span>()&#123;</span><br><span class="line">innobackupex --user=<span class="variable">$&#123;name&#125;</span> --password=<span class="variable">$&#123;passwd&#125;</span> --no-timestamp --incremental \</span><br><span class="line">--incremental-basedir=/<span class="variable">$&#123;backup_dir&#125;</span>/full_$(<span class="built_in">date</span> +%F -d <span class="string">&quot;-<span class="variable">$wdate</span> days&quot;</span>)--0/ /backup/inc<span class="variable">$&#123;wdate&#125;</span>_$(<span class="built_in">date</span> +%F)--<span class="variable">$&#123;wdate&#125;</span>  &amp;&gt; /dev/null </span><br><span class="line"></span><br><span class="line">to_lsn0=$(awk <span class="string">&#x27;NR==3&#123;print $3&#125;&#x27;</span>  /backup/full_$(<span class="built_in">date</span> +%F -d <span class="string">&quot;-<span class="variable">$wdate</span> days&quot;</span>)--0/xtrabackup_checkpoints)</span><br><span class="line">from_lsn<span class="variable">$&#123;wdate&#125;</span>=$(awk <span class="string">&#x27;NR==2&#123;print $3&#125;&#x27;</span>  /backup/inc<span class="variable">$&#123;wdate&#125;</span>_$(<span class="built_in">date</span> +%F)--<span class="variable">$&#123;wdate&#125;</span>/xtrabackup_checkpoints)</span><br><span class="line"></span><br><span class="line">[ <span class="variable">$&#123;to_lsn0&#125;</span> -ne <span class="variable">$&#123;from_lsn1&#125;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&#x27;周$&#123;wdate&#125;差异备份失败&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$&#123;wdate&#125;</span> <span class="keyword">in</span></span><br><span class="line">0)</span><br><span class="line">innobackupex --user=<span class="variable">$&#123;name&#125;</span> --password=<span class="variable">$&#123;passwd&#125;</span> --no-timestamp /<span class="variable">$&#123;backup_dir&#125;</span>/full_$(<span class="built_in">date</span> +%F)--<span class="variable">$&#123;wdate&#125;</span> &amp;&gt; /dev/null</span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">1|2|3|4|5|6)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 周一至周六执行差异备份  </span></span><br><span class="line"></span><br><span class="line">inc</span><br><span class="line"></span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 设定 MySQL 用户和密码  </span></span><br><span class="line">MYSQL_USER=<span class="string">&quot;root&quot;</span>  </span><br><span class="line">MYSQL_PASSWORD=<span class="string">&quot;123&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 设定备份目录  </span></span><br><span class="line">BACKUP_DIR=<span class="string">&quot;/backup&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 获取当前日期和时间  </span></span><br><span class="line">DATE=$(<span class="built_in">date</span> +%Y-%m-%d--%H%M%S)  </span><br><span class="line">WEEKDAY=$(<span class="built_in">date</span> +%u)  <span class="comment"># %u 是以1（星期一）到7（星期日）的数字来表示的星期几  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 定义日志文件  </span></span><br><span class="line">LOG_FILE=<span class="string">&quot;<span class="variable">$BACKUP_DIR</span>/backup.log&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 函数：记录日志  </span></span><br><span class="line"><span class="function"><span class="title">log_info</span></span>() &#123;  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(date &#x27;+%Y-%m-%d %H:%M:%S&#x27;)</span> INFO: <span class="variable">$1</span>&quot;</span> &gt;&gt; <span class="string">&quot;<span class="variable">$LOG_FILE</span>&quot;</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 函数：执行全备  </span></span><br><span class="line"><span class="function"><span class="title">full_backup</span></span>() &#123;  </span><br><span class="line">    log_info <span class="string">&quot;Starting full backup...&quot;</span>  </span><br><span class="line">    xtrabackup --user=<span class="variable">$MYSQL_USER</span> --password=<span class="variable">$MYSQL_PASSWORD</span> --backup --target-dir=<span class="string">&quot;<span class="variable">$BACKUP_DIR</span>/full_<span class="variable">$DATE</span>&quot;</span>  </span><br><span class="line">    <span class="keyword">if</span> [ $? -eq 0 ]; <span class="keyword">then</span>  </span><br><span class="line">        log_info <span class="string">&quot;Full backup completed successfully.&quot;</span>  </span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        log_info <span class="string">&quot;Full backup failed.&quot;</span>  </span><br><span class="line">        <span class="built_in">exit</span> 1  </span><br><span class="line">    <span class="keyword">fi</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 函数：执行差异备份  </span></span><br><span class="line"><span class="function"><span class="title">incremental_backup</span></span>() &#123;  </span><br><span class="line">    last_full_backup=$(<span class="built_in">ls</span> -dt <span class="string">&quot;<span class="variable">$BACKUP_DIR</span>/full_*&quot;</span> | <span class="built_in">head</span> -n 2 | <span class="built_in">tail</span> -n 1)  </span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$last_full_backup</span>&quot;</span> ]; <span class="keyword">then</span>  </span><br><span class="line">        log_info <span class="string">&quot;No previous full backup found, performing full backup instead.&quot;</span>  </span><br><span class="line">        full_backup  </span><br><span class="line">        <span class="built_in">return</span>  </span><br><span class="line">    <span class="keyword">fi</span>  </span><br><span class="line">  </span><br><span class="line">    log_info <span class="string">&quot;Starting incremental backup based on <span class="variable">$last_full_backup</span>...&quot;</span>  </span><br><span class="line">    xtrabackup --user=<span class="variable">$MYSQL_USER</span> --password=<span class="variable">$MYSQL_PASSWORD</span> --backup --target-dir=<span class="string">&quot;<span class="variable">$BACKUP_DIR</span>/inc_<span class="variable">$DATE</span>&quot;</span> --incremental-basedir=<span class="string">&quot;<span class="variable">$last_full_backup</span>&quot;</span>  </span><br><span class="line">    <span class="keyword">if</span> [ $? -eq 0 ]; <span class="keyword">then</span>  </span><br><span class="line">        log_info <span class="string">&quot;Incremental backup completed successfully.&quot;</span>  </span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        log_info <span class="string">&quot;Incremental backup failed.&quot;</span>  </span><br><span class="line">        <span class="built_in">exit</span> 1  </span><br><span class="line">    <span class="keyword">fi</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 根据星期几执行备份  </span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$WEEKDAY</span> <span class="keyword">in</span>  </span><br><span class="line">    7)  <span class="comment"># 星期日  </span></span><br><span class="line">        full_backup  </span><br><span class="line">        ;;  </span><br><span class="line">    [1-6])  <span class="comment"># 星期一到星期六  </span></span><br><span class="line">        incremental_backup  </span><br><span class="line">        ;;  </span><br><span class="line">    *)  </span><br><span class="line">        log_info <span class="string">&quot;Unknown weekday <span class="variable">$WEEKDAY</span>, skipping backup.&quot;</span>  </span><br><span class="line">        <span class="built_in">exit</span> 0  </span><br><span class="line">        ;;  </span><br><span class="line"><span class="keyword">esac</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 脚本结束  </span></span><br><span class="line">log_info <span class="string">&quot;Backup script finished.&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="3-时间同步"><a href="#3-时间同步" class="headerlink" title="3. 时间同步"></a>3. 时间同步</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同步网络时间：</span></span><br><span class="line">yum install -y ntp</span><br><span class="line">crontab -e</span><br><span class="line"></span><br><span class="line">name：<span class="built_in">sync</span> system time</span><br><span class="line">* * * * * /usr/sbin/ntpdate cn.pool.ntp.org &amp;&gt;/dev/null</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1、准备工作目录</span><br><span class="line">[root@m01 opt]# <span class="built_in">cd</span> /etc/ansible/roles/</span><br><span class="line">[root@m01 roles]# <span class="built_in">mkdir</span> ../&#123;group_vars,host_vars&#125;</span><br><span class="line">[root@m01 roles]# <span class="built_in">touch</span> ../site.yml</span><br><span class="line"></span><br><span class="line">2、使用命令创建项目的工作目录</span><br><span class="line">[root@m01 roles]# ansible-galaxy init ntp</span><br><span class="line">- Role lb was created successfully</span><br><span class="line"></span><br><span class="line">3、进入工作目录</span><br><span class="line">[root@m01 roles]# <span class="built_in">cd</span> ntp</span><br><span class="line"></span><br><span class="line">4、我想同步网络时间，我要书写任务</span><br><span class="line">[root@m01 files]# <span class="built_in">cd</span> ../tasks/</span><br><span class="line">[root@m01 tasks]# vim main.yml </span><br><span class="line">- name: 安装ntp服务</span><br><span class="line">  yum:</span><br><span class="line">  name: ntp</span><br><span class="line"></span><br><span class="line">- name: 同步网络时间</span><br><span class="line">  cron:</span><br><span class="line">    name: ntp同步网络时间</span><br><span class="line">    job: /usr/sbin/ntpdate cn.pool.ntp.org &amp;&gt;/dev/null</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5、site.yml的书写(书写入口文件)</span><br><span class="line">[root@m01 meta]# <span class="built_in">cd</span> ../..</span><br><span class="line"><span class="comment">############site.yml和roles平级！！！</span></span><br><span class="line">- hosts: all</span><br><span class="line">  roles:</span><br><span class="line">    - &#123;role: ntp&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">##检测</span></span><br><span class="line"><span class="built_in">date</span> 040115302023.30   <span class="comment">#修改时间</span></span><br><span class="line">2023年4月1日下午3点30分</span><br></pre></td></tr></table></figure>
<h2 id="4、搭建Nginx-Tomcat搭建Jpress"><a href="#4、搭建Nginx-Tomcat搭建Jpress" class="headerlink" title="4、搭建Nginx+Tomcat搭建Jpress"></a>4、搭建Nginx+Tomcat搭建Jpress</h2><p><strong>1. yum安装tomcat</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">文章来源：</span><br><span class="line">https://www.cnblogs.com/asheng2016/p/tomcat.html#2-yum安装mysql</span><br><span class="line"></span><br><span class="line">1. yum安装tomcat</span><br><span class="line">[root@m01 ~]# yum install tomcat tomcat-webapps tomcat-admin-webapps -y</span><br><span class="line"></span><br><span class="line">2. 启动tomcat</span><br><span class="line">[root@m01 ~]# systemctl start tomcat</span><br><span class="line">[root@m01 ~]# netstat -lntup | grep 8080</span><br><span class="line"></span><br><span class="line"><span class="comment">#tomcat默认监听在8080端口，注意不能冲突，默认的代码存放位置是/usr/share/tomcat/webapps/，安装完毕之后直接在浏览器中访问可看到默认页面：</span></span><br><span class="line">10.0.0.61:8080</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240615205940016.png" alt="image-20240615205940016"></p>
<p><strong>2. yum安装MySQL</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">3. 在db01数据库中创建jpress数据库 </span><br><span class="line">MariaDB [(none)]&gt; create database jpress;</span><br><span class="line"></span><br><span class="line">4. 创建远程登陆用户jp_user</span><br><span class="line">grant all on *.* to jp_user@<span class="string">&#x27;172.16.1.%&#x27;</span> identified by <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看刚刚创建的用户</span></span><br><span class="line">MariaDB [(none)]&gt; <span class="keyword">select</span> user,host from mysql.user;</span><br></pre></td></tr></table></figure>
<p><strong>3. 下载JPress并安装</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以到这下载0.4版本的war包</span></span><br><span class="line">http://git.oschina.net/GalaIO/jpress/blob/master/wars/jpress-web-newest.war</span><br><span class="line"></span><br><span class="line">我已经装备好了jpress包，上传到机器里面的，我就不远程下载了</span><br><span class="line"></span><br><span class="line">1、把jpress-web-newest.war移动到/usr/share/tomcat/webapps/，并且刷新一下10.0.0.7:8080，之后就会看到war包被tomcat自动解压了。</span><br><span class="line"></span><br><span class="line">[root@m01 ~]# <span class="built_in">mv</span> jpress-web-newest.war /usr/share/tomcat/webapps/</span><br><span class="line">[root@m01 ~]# <span class="built_in">ls</span> -lh /usr/share/tomcat/webapps/</span><br><span class="line">total 20M</span><br><span class="line">drwxr-xr-x 8 tomcat tomcat 127 Jun 16 04:56 examples</span><br><span class="line">drwxr-xr-x 5 root   tomcat  87 Jun 16 04:56 host-manager</span><br><span class="line">drwxr-xr-x 6 tomcat tomcat  86 Jun 16 05:27 jpress-web-newest</span><br><span class="line">-rw-rw-rw- 1 root   root   20M Jun 15 21:26 jpress-web-newest.war</span><br><span class="line">drwxr-xr-x 5 root   tomcat 103 Jun 16 04:56 manager</span><br><span class="line">drwxr-xr-x 3 tomcat tomcat 306 Jun 16 04:56 ROOT</span><br><span class="line">drwxr-xr-x 5 tomcat tomcat  86 Jun 16 04:56 sample</span><br><span class="line"></span><br><span class="line">jpress-web-newest.war是我们移动过来的。jpress-web-newest目录是tomcat帮我们解压的，其它目录都是之前就已经存在的，不用管。</span><br><span class="line"></span><br><span class="line">2、 浏览器访问10.0.0.61:8080/jpress-web-newest开始安装JPress</span><br><span class="line"></span><br><span class="line">安装流程和其它产品基本一致，无外乎是提供数据库信息和创建网站管理员账号。</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240615212034538.png" alt="image-20240615212034538" style="zoom:67%;" /></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240615213309521.png" alt="image-20240615213309521" style="zoom:67%;" /></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240615213423218.png" alt="image-20240615213423218" style="zoom:67%;" /></p>
<p>安装完毕需要重启一次tomcat，才可以正常访问。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@m01 ~]# systemctl restart tomcat</span><br><span class="line"></span><br><span class="line">浏览器访问jpress首页：在浏览器中输入</span><br><span class="line">10.0.0.61:8080/jpress-web-newest/</span><br><span class="line"></span><br><span class="line">jpress后台管理页面</span><br><span class="line">10.0.0.61:8080/jpress-web-newest/admin/</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240615213704686.png" alt="image-20240615213704686"></p>
<p>press后台管理页面：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240615213919112.png" alt="image-20240615213919112" style="zoom:67%;" /></p>
<p>到目前为止，我们的JPress已经可以单独使用了，接下来我们利用nginx代理转发功能，配置nginx让它们协同工作。</p>
<p><strong>4. 配置tomcat使其可以部署多个网站</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">如果熟悉nginx使用的话，可能会有个疑问，每次访问jpress博客，都需要输入10.0.0.7:8080/jpress-web-newest/这么一大串，默认端口不用80也就不说了，还需要输入自己输入目录结构，显然不太合理，并且这样做的话，nginx配置代理转发就玩不转了，因此我们需要把jpress给搬移到一个合适的位置。</span><br><span class="line"></span><br><span class="line">我们知道直接访问10.0.0.7:8080打开的是tomcat默认页面，这个页面的代码是写在/usr/share/tomcat/webapps/ROOT/目录里的，当然可以把这里面的内容全部删除，然后把jpress代码<span class="built_in">mv</span>进来，显然这不是最佳解决方案，如果还需要安装其它产品，又玩不转了。</span><br><span class="line"></span><br><span class="line">最终我们觉得采用下述方案了部署第2个产品(默认是第1个，jpress是第2个)：</span><br><span class="line"></span><br><span class="line">复制一份/usr/share/tomcat/webapps/</span><br><span class="line">修改/usr/share/tomcat/conf/server.xml，增加第2套配置</span><br><span class="line">详细操作步骤如下：</span><br><span class="line"></span><br><span class="line"><span class="comment">#1.复制一份webapps并命名为webapps-jpress</span></span><br><span class="line">[root@m01 ~]# <span class="built_in">cp</span> -rp /usr/share/tomcat/webapps/ /usr/share/tomcat/webapps-jpress</span><br><span class="line">注意目录属性，用户身份，需保持不变</span><br><span class="line"></span><br><span class="line"><span class="comment">#2 把jpress的代码全部移动到/usr/share/tomcat/webapps-jpress</span></span><br><span class="line">[root@m01 webapps-jpress]# <span class="built_in">cd</span> /usr/share/tomcat/webapps-jpress; <span class="built_in">pwd</span></span><br><span class="line">/usr/share/tomcat/webapps-jpress</span><br><span class="line">[root@m01 webapps-jpress]#   <span class="built_in">rm</span> -rf ROOT/*</span><br><span class="line">[root@m01 webapps-jpress]# <span class="built_in">mv</span> jpress-web-newest/* ROOT/</span><br><span class="line">[root@m01 webapps-jpress]# <span class="built_in">ls</span> -l /usr/share/tomcat/webapps-jpress/ROOT/</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x  3 tomcat tomcat  38 Jun 16 05:27 META-INF</span><br><span class="line">-rw-r--r--  1 tomcat tomcat  96 Jul 27  2016 robots.txt</span><br><span class="line">drwxr-xr-x 11 tomcat tomcat 139 Jun 16 05:27 static</span><br><span class="line">drwxr-xr-x  4 tomcat tomcat  31 Jun 16 05:27 templates</span><br><span class="line">drwxr-xr-x  6 tomcat tomcat  75 Jun 16 05:27 WEB-INF</span><br><span class="line"></span><br><span class="line"><span class="comment">#3 修改/usr/share/tomcat/conf/server.xml</span></span><br><span class="line">需要在/usr/share/tomcat/conf/server.xml添加一对Service标签，来是webapps-jpress文件生效，该文件里已经有一份默认Service标签是定义默认首页的，我们只需将其复制拷贝一份，再改改监听端口，即可据为己用，下面是一张去掉注释后的截图，可以作为对照：</span><br><span class="line"></span><br><span class="line"><span class="comment">#4.重启 tomcat ，检查端口</span></span><br><span class="line">[root@m01 webapps-jpress]# systemctl restart tomcat</span><br><span class="line">[root@m01 webapps-jpress]# netstat -lntup| grep 7070</span><br><span class="line">tcp6       0      0 :::7070                 :::*                    LISTEN      13307/java   </span><br><span class="line"></span><br><span class="line"><span class="comment">#5. 此时浏览器访问10.0.0.61:7070可以直接看到jpress页面：</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://md-img-1252230138.cos.ap-beijing.myqcloud.com/2018-10-03-19-35-24.png" alt="img"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240615220951890.png" alt="image-20240615220951890"></p>
<p><strong>5. 安装nginx并配置</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">下面就是配置nginx代理tomcat，实现域名直接访问jpress</span><br><span class="line"></span><br><span class="line"><span class="comment">#1 安装nginx并进行一些基础优化</span></span><br><span class="line">[root@web01 ~]# yum install nginx -y</span><br><span class="line"><span class="comment">#添加虚拟用户www</span></span><br><span class="line">groupadd -g 666 www</span><br><span class="line">useradd -u666 -g666 -s /sbin/nologin -M www</span><br><span class="line"><span class="comment">#设置nginx运行用户为www</span></span><br><span class="line">sed -i <span class="string">&#x27;/^user/user www;&#x27;</span> /etc/nginx/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.  配置nginx jpress.conf</span></span><br><span class="line">[root@m01 webapps-jpress]# vim /etc/nginx/conf.d/jpress.conf</span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name www.jpress.com;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass       http://127.0.0.1:7070/;</span><br><span class="line">        proxy_set_header Host            <span class="variable">$http_host</span>;</span><br><span class="line">        proxy_set_header X-Real-IP       <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"></span><br><span class="line">        proxy_connect_timeout 30;</span><br><span class="line">        proxy_send_timeout    60;</span><br><span class="line">        proxy_read_timeout    60;</span><br><span class="line"></span><br><span class="line">        proxy_buffering      on;</span><br><span class="line">        proxy_buffer_size    32k;</span><br><span class="line">        proxy_buffers        4 128k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@m01 webapps-jpress]# nginx -t</span><br><span class="line">[root@m01 webapps-jpress]# systemctl restart nginx</span><br><span class="line"></span><br><span class="line">最关键的就是这一行proxy_pass http://127.0.0.1:7070/;</span><br><span class="line"></span><br><span class="line"><span class="comment">#3 设置windows hosts文件解析</span></span><br><span class="line"></span><br><span class="line">C:\Windows\System32\drivers\etc\hosts</span><br><span class="line">10.0.0.61 www.jpress.com</span><br><span class="line"></span><br><span class="line"><span class="comment">#4. 浏览器访问</span></span><br><span class="line"> www.jpress.com </span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240615222801082.png" alt="image-20240615222801082"></p>
<p>访问后台管理页面  www.jpress.com/admin   </p>
<p>进入后台页面，先发布一个文章</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240615222921293.png" alt="image-20240615222921293"></p>
<p><strong>6. 将已经安装好的jpress打包</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">本步骤是可选项，主要是为了方便在多台机器部署jpress，这里的打包就是Linux上的.tar.gz压缩包，比较简单就是利用tomcat把.war解压之后打成压缩包方便日后使用。但是我更喜欢一种更彻底的打包，把整个/usr/share/tomcat/webapps-jpress/打包，并且把数据库备份，以后再安装直接解压，导入数据库，搞定。</span><br><span class="line"></span><br><span class="line">如果再此安装时，数据库连接信息变更，则需要修改数据库连接信息，使用下述命令可以查找jpress数据库连接信息在哪：</span><br><span class="line">[root@web01 ~]# grep -R <span class="string">&#x27;As4k.top&#x27;</span> /usr/share/tomcat/webapps-jpress/</span><br><span class="line">/usr/share/tomcat/webapps-jpress/ROOT/WEB-INF/classes/db.properties:db_password=As4k.top</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#打包目录使用tar命令即可：</span></span><br><span class="line">[root@m01 webapps-jpress]# <span class="built_in">cd</span> /usr/share/tomcat/; <span class="built_in">pwd</span></span><br><span class="line">/usr/share/tomcat</span><br><span class="line">[root@m01 tomcat]# <span class="built_in">mkdir</span> ~/jp_ansible</span><br><span class="line">[root@m01 tomcat]# tar zcf webapps-jpress.tgz webapps-jpress</span><br><span class="line"></span><br><span class="line"><span class="comment">#别忘了/usr/share/tomcat/conf/server.xml也要保留一份。</span></span><br><span class="line">[root@m01 tomcat]# <span class="built_in">cp</span> /usr/share/tomcat/conf/server.xml ~/jp_ansible</span><br><span class="line">[root@m01 tomcat]# <span class="built_in">mv</span> webapps-jpress.tgz ~/jp_ansible</span><br><span class="line"></span><br><span class="line"><span class="comment">#备份jpress网页配置文件</span></span><br><span class="line">[root@m01 tomcat]# <span class="built_in">cp</span> /etc/nginx/conf.d/jpress.conf  ~/jp_ansible</span><br><span class="line"></span><br><span class="line"><span class="comment">#db01机器备份jpress数据库：</span></span><br><span class="line">[root@db01 ~]# mysqldump -B jpress &gt; /tmp/jpress.sql</span><br><span class="line">[root@db01 ~]# scp /tmp/jpress.sql  root@172.16.1.61:/root/jp_ansible</span><br><span class="line"></span><br><span class="line"><span class="comment">#用户上传图片存放的目录</span></span><br><span class="line">/usr/share/tomcat/webapps-jpress/ROOT/attachment</span><br><span class="line"></span><br><span class="line">登录数据库，查看写的博客在数据库中的位置。</span><br><span class="line">MariaDB [(none)]&gt; <span class="keyword">select</span> * from jpress.jpress_content\G</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">可以重启nginx</span><br><span class="line">关闭防火墙</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240617174708695.png" alt="image-20240617174708695"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据库无法启动</span></span><br><span class="line"></span><br><span class="line">[root@db02 ~]# systemctl start mariadb</span><br><span class="line">Job <span class="keyword">for</span> mariadb.service failed because the control process exited with error code. See <span class="string">&quot;systemctl status mariadb.service&quot;</span> and <span class="string">&quot;journalctl -xe&quot;</span> <span class="keyword">for</span> details.</span><br><span class="line">[root@db02 ~]# <span class="built_in">cp</span> /usr/share/mysql/my-huge.cnf /etc/my.cnf</span><br><span class="line"><span class="built_in">cp</span>: overwrite ‘/etc/my.cnf’? y</span><br><span class="line">[root@db02 ~]# systemctl start mariadb.service</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如下报错的解决办法：</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240619163832230.png" alt="image-20240619163832230"></p>
<h2 id="5-zabbix监控，监控一台机器"><a href="#5-zabbix监控，监控一台机器" class="headerlink" title="5. zabbix监控，监控一台机器"></a>5. zabbix监控，监控一台机器</h2><div class="table-container">
<table>
<thead>
<tr>
<th>主机名</th>
<th>ip</th>
<th>角色</th>
</tr>
</thead>
<tbody>
<tr>
<td>zabbix</td>
<td>10.0.0.71 / 172.16.1.71</td>
<td>zabbix 服务端</td>
</tr>
<tr>
<td>web01</td>
<td>10.0.0.7 / 172.16.1.7</td>
<td>zabbix 客户端</td>
</tr>
</tbody>
</table>
</div>
<p>一、部署zabbix服务端</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#zabbix官网安装步骤网址</span></span><br><span class="line">https://www.zabbix.com/cn/download?zabbix=5.0&amp;os_distribution=centos&amp;os_version=7&amp;components=server_frontend_agent&amp;db=mysql&amp;ws=apache</span><br><span class="line"></span><br><span class="line">1、配置zabbix仓库</span><br><span class="line">[root@zabbix ~]# rpm -Uvh https://repo.zabbix.com/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm</span><br><span class="line">Retrieving https://repo.zabbix.com/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm</span><br><span class="line">warning: /var/tmp/rpm-tmp.atkoeM: Header V4 RSA/SHA512 Signature, key ID a14fe591: NOKEY</span><br><span class="line">Preparing...                          <span class="comment">################################# [100%]</span></span><br><span class="line">Updating / installing...</span><br><span class="line">   1:zabbix-release-5.0-1.el7         <span class="comment">################################# [100%]</span></span><br><span class="line"> </span><br><span class="line">2、清除缓存</span><br><span class="line">[root@zabbix ~]# yum clean all</span><br><span class="line"></span><br><span class="line">3、安装Zabbix server，Web前端，agent 数据库</span><br><span class="line">[root@zabbix ~]#  yum install zabbix-server-mysql zabbix-agent mariadb-server -y </span><br><span class="line"></span><br><span class="line">4、启用Red Hat软件集合 安装scl源 解决版本冲突问题</span><br><span class="line">[root@zabbix ~]#  yum install centos-release-scl -y</span><br><span class="line"></span><br><span class="line">5、编辑配置文件 启用zabbix前端存储库</span><br><span class="line">[root@zabbix ~]# vim  /etc/yum.repos.d/zabbix.repo </span><br><span class="line">[zabbix-frontend]</span><br><span class="line">...</span><br><span class="line">enabled=1</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">6、安装Zabbix前端软件包。</span><br><span class="line">[root@zabbix ~]# yum -y install zabbix-web-mysql-scl zabbix-apache-conf-scl</span><br></pre></td></tr></table></figure>
<p>二、配置zabbix服务端的数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">1、启动数据库</span><br><span class="line">[root@zabbix ~]# systemctl start mariadb</span><br><span class="line">[root@zabbix ~]# systemctl <span class="built_in">enable</span> mariadb</span><br><span class="line"></span><br><span class="line">2、创建zabbix库</span><br><span class="line">[root@zabbix ~]# mysql</span><br><span class="line">MariaDB [(none)]&gt; create database zabbix character <span class="built_in">set</span> utf8 collate utf8_bin;</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;  create user zabbix@localhost identified by <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; grant all privileges on zabbix.* to zabbix@localhost;</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; <span class="built_in">set</span> global log_bin_trust_function_creators = 1;</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; quit;</span><br><span class="line"></span><br><span class="line">3、导入初始架构和数据，系统将提示输入新创建的密码。</span><br><span class="line">初始化数据(业务运行前需要依赖数据库中的一些数据表格 需要提前导入)</span><br><span class="line">[root@zabbix ~]# zcat /usr/share/doc/zabbix-server-mysql*/create.sql.gz | mysql -uzabbix -p zabbix</span><br><span class="line">Enter password: <span class="comment">#我配置的密码是123</span></span><br><span class="line"></span><br><span class="line">4、导入数据库架构后禁用log_bin_trust_function_creators选项。</span><br><span class="line">[root@zabbix ~]# mysql</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; <span class="built_in">set</span> global log_bin_trust_function_creators = 0;</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; quit</span><br><span class="line"></span><br><span class="line">5、配置zabbix连接数据的信息</span><br><span class="line">[root@zabbix ~]# vim  /etc/zabbix/zabbix_server.conf</span><br><span class="line">DBName=zabbix</span><br><span class="line">DBUser=zabbix</span><br><span class="line">DBPassword=123     <span class="comment">#将注释打开配置创建数据库中的zabbix用户的密码</span></span><br><span class="line"></span><br><span class="line">6、修改时区</span><br><span class="line">[root@zabbix ~]# <span class="built_in">echo</span> <span class="string">&quot;php_value[date.timezone] = Asia/ShangHai&quot;</span> &gt;&gt; /etc/opt/rh/rh-php72/php-fpm.d/zabbix.conf</span><br><span class="line">或者</span><br><span class="line">[root@zabbix ~]# <span class="built_in">tail</span> -1 /etc/opt/rh/rh-php72/php-fpm.d/zabbix.conf</span><br><span class="line">                 php_value[date.timezone] = Asia/ShangHai</span><br><span class="line"></span><br><span class="line">7、启动服务 server agent httpd php 加入开机自启</span><br><span class="line">[root@zabbix ~]# systemctl start zabbix-server zabbix-agent httpd rh-php72-php-fpm;systemctl <span class="built_in">enable</span> zabbix-server zabbix-agent httpd rh-php72-php-fpm</span><br><span class="line"></span><br><span class="line">8、我zabbix服务器的ip是10.0.0.71</span><br><span class="line">打开浏览器访问：http://10.0.0.71/zabbix</span><br></pre></td></tr></table></figure>
<h6 id="下面这段不用管，写roles可以参考下面这个方法步骤，导入数据库的时候不用输密码，先导入数据库，再创建用户"><a href="#下面这段不用管，写roles可以参考下面这个方法步骤，导入数据库的时候不用输密码，先导入数据库，再创建用户" class="headerlink" title="######下面这段不用管，写roles可以参考下面这个方法步骤，导入数据库的时候不用输密码，先导入数据库，再创建用户"></a>######下面这段不用管，写roles可以参考下面这个方法步骤，导入数据库的时候不用输密码，先导入数据库，再创建用户</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#2、连接数据库</span></span><br><span class="line">[root@zabbix ~]# mysql</span><br><span class="line"></span><br><span class="line"><span class="comment">#3、创建zabbix库</span></span><br><span class="line">MariaDB [(none)]&gt; create database zabbix character <span class="built_in">set</span> utf8 collate utf8_bin;</span><br><span class="line"></span><br><span class="line"><span class="comment">#4、退出数据库</span></span><br><span class="line">MariaDB [(none)]&gt; <span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#5、进入SQL文件目录</span></span><br><span class="line">[root@zabbix ~]# <span class="built_in">cd</span> /usr/share/doc/zabbix-server-mysql-3.4.15/</span><br><span class="line"></span><br><span class="line"><span class="comment">#6、导入SQL文件</span></span><br><span class="line">[root@zabbix zabbix-server-mysql-3.4.15]# zcat create.sql.gz |mysql zabbix</span><br><span class="line"></span><br><span class="line"><span class="comment">#7、检查导入结果</span></span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| <span class="built_in">test</span>               |</span><br><span class="line">| zabbix             |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use zabbix;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">MariaDB [zabbix]&gt; show tables;</span><br><span class="line">+----------------------------+</span><br><span class="line">| Tables_in_zabbix           |</span><br><span class="line">+----------------------------+</span><br><span class="line">| acknowledges               |</span><br><span class="line">| actions                    |</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#8、创建用户</span></span><br><span class="line">MariaDB [zabbix]&gt; grant all on zabbix.* to zabbix@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;123&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>在浏览器中访问         10.0.0.71/zabbix</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621210113227.png" alt="image-20240621210113227"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621210332061.png" alt="image-20240621210332061"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621210501091.png" alt="image-20240621210501091"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621210531319.png" alt="image-20240621210531319"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621210612955.png" alt="image-20240621210612955"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621210630905.png" alt="image-20240621210630905"></p>
<p>默认账号： Admin</p>
<p>默认密码： zabbix</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621210743411.png" alt="image-20240621210743411"></p>
<p>加入页面之后是英文的，不方便阅读</p>
<p>调整为中文字体</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621210959619.png" alt="image-20240621210959619"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621211330330.png" alt="image-20240621211330330"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621211405717.png" alt="image-20240621211405717"></p>
<p>解决中文无法显示的问题</p>
<p>查找windows字体（如：黑体常规）    复制到zabbix的字体目录下/usr/share/fonts/dejavu/</p>
<p>windows字体位置：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621211619700.png" alt="image-20240621211619700"></p>
<p>上传其中一个字体到/usr/share/fonts/dejavu/ 并改名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix ~]# <span class="built_in">cd</span> /usr/share/fonts/dejavu/</span><br><span class="line"></span><br><span class="line">[root@zabbix dejavu]# rz</span><br><span class="line">rz waiting to receive.**[root@zabbix dejavu]# ll</span><br><span class="line">total 5328</span><br><span class="line">-rw-r--r-- 1 root root 611212 Feb 27  2011 DejaVuSans-BoldOblique.ttf</span><br><span class="line">-rw-r--r-- 1 root root 672300 Feb 27  2011 DejaVuSans-Bold.ttf</span><br><span class="line">-rw-r--r-- 1 root root 580168 Feb 27  2011 DejaVuSansCondensed-BoldOblique.ttf</span><br><span class="line">-rw-r--r-- 1 root root 631992 Feb 27  2011 DejaVuSansCondensed-Bold.ttf</span><br><span class="line">-rw-r--r-- 1 root root 576004 Feb 27  2011 DejaVuSansCondensed-Oblique.ttf</span><br><span class="line">-rw-r--r-- 1 root root 643852 Feb 27  2011 DejaVuSansCondensed.ttf</span><br><span class="line">-rw-r--r-- 1 root root 345204 Feb 27  2011 DejaVuSans-ExtraLight.ttf</span><br><span class="line">-rw-r--r-- 1 root root 611556 Feb 27  2011 DejaVuSans-Oblique.ttf</span><br><span class="line">-rw-r--r-- 1 root root 720012 Feb 27  2011 DejaVuSans.ttf</span><br><span class="line">-rw-rw-rw- 1 root root 9753284 Feb 11  2017 SIMHEI.TTF</span><br><span class="line"></span><br><span class="line"><span class="comment">#备份默认的字体</span></span><br><span class="line">[root@zabbix dejavu]# <span class="built_in">mv</span> DejaVuSans.ttf DejaVuSans.ttf.bak</span><br><span class="line"></span><br><span class="line"><span class="comment">#将上传的字体重命名为默认的字体</span></span><br><span class="line">[root@zabbix dejavu]# [root@zabbix dejavu]# <span class="built_in">mv</span> SIMHEI.TTF DejaVuSans.ttf</span><br><span class="line"></span><br><span class="line"><span class="comment">#重启zabbix-server</span></span><br><span class="line">[root@zabbix dejavu]# systemctl restart zabbix-server</span><br></pre></td></tr></table></figure>
<p>三、配置zabbix客户端   安装5.0客户端:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">1、配置仓库</span><br><span class="line">[root@web01 ~]#  rpm -Uvh https://repo.zabbix.com/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm</span><br><span class="line">如果安装提示软件冲突:</span><br><span class="line">[root@web02 ~]# yum -y install centos-release-scl</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2、安装客户端agent</span><br><span class="line">[root@web02 ~]# yum -y install zabbix-agent</span><br><span class="line"></span><br><span class="line">3、配置客户端并启动</span><br><span class="line"><span class="comment">#修改配置文件 将客户端的ip写入配置文件</span></span><br><span class="line">[root@web01 ~]# vim /etc/zabbix/zabbix_agentd.conf </span><br><span class="line">Server=172.16.1.71</span><br><span class="line">ServerActive=172.16.1.71</span><br><span class="line"></span><br><span class="line">4、启动</span><br><span class="line">[root@web01 ~]#  systemctl start zabbix-agent; systemctl <span class="built_in">enable</span> zabbix-agent</span><br><span class="line">检查10050端口</span><br><span class="line">[root@web01 ~]# netstat -lntup| grep zabbix</span><br><span class="line">tcp        0      0 0.0.0.0:10050           0.0.0.0:*               LISTEN      16075/zabbix_agentd </span><br><span class="line">tcp6       0      0 :::10050                :::*                    LISTEN      16075/zabbix_agentd </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5、在web页面添加监控</span><br><span class="line"><span class="comment">#添加监控之前我们必须保证被监控的机器(zabbix-agent机器)10050端口可以通信</span></span><br><span class="line">[root@web01 ~]# telnet 10.0.0.7 10050</span><br><span class="line">Trying 10.0.0.7...</span><br><span class="line">Connected to 10.0.0.7.</span><br><span class="line">Escape character is <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line">Connection closed by foreign host.</span><br></pre></td></tr></table></figure>
<p>四、.zabbix添加监控web01</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621215247428.png" alt="image-20240621215247428"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621215619555.png" alt="image-20240621215619555"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621215826804.png" alt="image-20240621215826804"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240621220115994.png" alt="image-20240621220115994"></p>
<h2 id="6-Git-构建分布式版本控制系统"><a href="#6-Git-构建分布式版本控制系统" class="headerlink" title="6. Git 构建分布式版本控制系统"></a>6. Git 构建分布式版本控制系统</h2><p>记录开发文件的时间机器  更好的开发  挽回代码错误带来的损失</p>
<p>Gitlab私有的git   web服务器</p>
<p>—————————————————————<strong>搭建Gitlab</strong>————————————————————</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">官网： https://gitlab.cn/install/</span><br><span class="line">安装要求： 内存4G以上  </span><br><span class="line"></span><br><span class="line">1. 安装和配置所需的依赖</span><br><span class="line">在 CentOS 7 上，下面的命令会在系统防火墙中打开 HTTP、HTTPS 和 SSH 访问。这是一个可选步骤，如果你打算仅从本地网络访问极狐GitLab，则可以跳过它。</span><br><span class="line"><span class="comment">#安装策略文件 安装邮箱程序   如果是root用户安装 不需要加sudo</span></span><br><span class="line">yum install -y curl policycoreutils-python openssh-server perl postfix</span><br><span class="line">systemctl start sshd;systemctl <span class="built_in">enable</span> sshd</span><br><span class="line">systemctl start postfix;systemctl <span class="built_in">enable</span> postfix</span><br><span class="line"><span class="comment">#curl浏览器程序</span></span><br><span class="line"><span class="comment">#policycoreutils-python  加密程序</span></span><br><span class="line"><span class="comment">#openssh-server  远程登陆服务</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3. 下载并安装极狐GitLab</span><br><span class="line">执行以下命令配置极狐GitLab 软件源镜像。</span><br><span class="line">curl -fsSL https://get.gitlab.cn | /bin/bash</span><br><span class="line">接下来执行如下命令开始安装：</span><br><span class="line"><span class="built_in">sudo</span> EXTERNAL_URL=<span class="string">&quot;https://gitlab.example.com&quot;</span> yum install -y gitlab-jh</span><br><span class="line"></span><br><span class="line"><span class="comment">##我提前准备了安装包所以上传解压的</span></span><br><span class="line">[root@jmpserver ~]# <span class="built_in">ls</span></span><br><span class="line">6.Git-software.zip    <span class="comment">#Git安装包</span></span><br><span class="line">github2.pdf           <span class="comment">#git的命令资料</span></span><br><span class="line">gitlab-ce-9.1.0-ce.0.el7.x86_64.rpm  <span class="comment">#Git的rpm包</span></span><br><span class="line">[root@jmpserver ~]# yum -y install gitlab-ce-9.1.0-ce.0.el7.x86_64.rpm</span><br><span class="line"></span><br><span class="line">4、自动配置文件权限,安装数据库….  提示!安装的时间会3分钟以上</span><br><span class="line">[root@jmpserver ~]#  gitlab-ctl reconfigure</span><br><span class="line"></span><br><span class="line">5、关闭防火墙</span><br><span class="line">[root@jmpserver jumpserver-installer-v3.10.10]# systemctl stop firewalld</span><br><span class="line"></span><br><span class="line">使用浏览器访问这个机器的ip 就可以出现gitlab的页面</span><br><span class="line">10.0.0.74</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">启动:<span class="built_in">sudo</span> gitlaba -ctl start</span><br><span class="line">停止:<span class="built_in">sudo</span> gitlab-ctl stop</span><br><span class="line">重启:<span class="built_in">sudo</span> gitlab-ctl restart</span><br><span class="line"></span><br><span class="line">6. 登录极狐GitLab 实例</span><br><span class="line">使用第二步 EXTERNAL_URL 中配置的地址来访问安装成功的极狐GitLab 实例。用户名默认为 root 。如果在安装过程中指定了初始密码，则用初始密码登录，如果未指定密码，则系统会随机生成一个密码并存储在 /etc/gitlab/initial_root_password 文件中， 查看随机密码并使用 root 用户名登录。</span><br><span class="line"></span><br><span class="line">注意：出于安全原因，24 小时后，/etc/gitlab/initial_root_password 会被第一次 gitlab-ctl reconfigure 自动删除，因此若使用随机密码登录，建议安装成功初始登录成功之后，立即修改初始密码</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622125112777.png" alt="image-20240622125112777"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622125221466.png" alt="image-20240622125221466"></p>
<p><strong>进入首页   创建项目</strong></p>
<p>1、创建项目</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622125652384.png" alt="image-20240622125652384"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622130151003.png" alt="image-20240622130151003"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622130824625.png" alt="image-20240622130824625"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622132252202.png" alt="image-20240622132252202"></p>
<p>2、建立远程连接的密钥，才能够访问使用  推送SSH密钥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">##用于命令行，或客户端程序进行下载使用。</span></span><br><span class="line">http://root@jmpserver/root/asm-project1.git   <span class="comment">#复制的项目地址 HHTP</span></span><br><span class="line"></span><br><span class="line">git@jmpserver:root/asm-project1.git   <span class="comment">#SSH</span></span><br><span class="line"></span><br><span class="line">1、生成密钥  并且查看密钥</span><br><span class="line">[root@jmpserver ~]# ssh-keygen</span><br><span class="line"></span><br><span class="line">[root@jmpserver ~]# <span class="built_in">cat</span> ~/.ssh/id_rsa.pub </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCpfy6pS4Pc2UiH+mer+CpSsVL5WslEmzydUlCc/2wNTXbFCE7xR7XchAA0h4f3g5NgT9YgqQRGzxiZ07+pLJ6V6PPFPWMe4iriLK4Yb52emOPUYtYdwBcJkXDHSre/ZDko6JICyFdwwuDtYBSvUniYXm5fFcDysKfAp027HDr40yisClGwS6wAICT1cblNw3DpTCG6g4Kh1JjnPdIVA6P2VgRt9hvplo8p4EqV9CoVrGNz/Mgcb411V6XYNdIAtQE/cVmyRbZ9T1LfHle8eYnoM+FwF9dJrZ2Z5qndZ0M7AmIROMxiHxROEQVb0aHbmQCPIcZR+cg34K77K3GmQjVP root@jmpserver</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622131946536.png" alt="image-20240622131946536"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622131719280.png" alt="image-20240622131719280"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622131852805.png" alt="image-20240622131852805"></p>
<p>3、使用gitlab</p>
<ul>
<li>图形操作  上传到gitlab</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622132833245.png" alt="image-20240622132833245"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622132940068.png" alt="image-20240622132940068"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622132955275.png" alt="image-20240622132955275"></p>
<ul>
<li>上传本地的文件到gitlab</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622133236208.png" alt="image-20240622133236208"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622133409132.png" alt="image-20240622133409132"></p>
<ul>
<li><p>下载项目的文件</p>
</li>
<li><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622134628219.png" alt="image-20240622134628219"></p>
<ul>
<li></li>
<li>命令行操作</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622135855048.png" alt="image-20240622135855048"></li>
</ul>
<p>下载</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1、如果你的机器的有域名的，需要在/etc/hosts做域名解析</span><br><span class="line">10.0.0.74 www.gitlab.com  </span><br><span class="line"><span class="comment">###如果没有就不需要做这步</span></span><br><span class="line"></span><br><span class="line">安装git</span><br><span class="line">[root@m01 ~]# yum -y install git</span><br><span class="line"></span><br><span class="line">1、克隆服务器的文件  注意你粘贴的地址中，使用了什么用户名！！！</span><br><span class="line">[root@jmpserver ~]# git config --global user.name <span class="string">&quot;git&quot;</span>              <span class="comment">#可以用root 也可以用git  git是自动创建的 没有密码</span></span><br><span class="line">[root@jmpserver ~]# git config --global user.email <span class="string">&quot;git@jmpserver&quot;</span>   <span class="comment">#邮箱</span></span><br><span class="line">[root@jmpserver ~]# git <span class="built_in">clone</span> git@jmpserver:root/asm-project1.git</span><br><span class="line">git@jmpserver:root/asm-project1.git <span class="comment">#我之前粘贴的地址</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@jmpserver ~]# <span class="built_in">ls</span></span><br><span class="line">asm-project1  </span><br><span class="line"> <span class="comment">#会看到我远程下载的文件</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622135410435.png" alt="image-20240622135410435"></p>
<p>将服务器的文件上传到远端</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"> [root@jmpserver ~]# <span class="built_in">ls</span></span><br><span class="line">asm-project1  </span><br><span class="line"></span><br><span class="line">1、进入工作目录</span><br><span class="line">[root@jmpserver ~]# <span class="built_in">cd</span> asm-project1/</span><br><span class="line">[root@jmpserver asm-project1]# <span class="built_in">echo</span> php &gt; index.html</span><br><span class="line"></span><br><span class="line">2、初始化</span><br><span class="line">[root@jmpserver asm-project1]# git init</span><br><span class="line">Reinitialized existing Git repository <span class="keyword">in</span> /root/asm-project1/.git/</span><br><span class="line"></span><br><span class="line">3、告诉服务器上传的地址</span><br><span class="line">[root@jmpserver asm-project1]# git remote add origin git@jmpserver:root/asm-project1.git</span><br><span class="line">fatal: remote origin already exists.</span><br><span class="line"></span><br><span class="line">4、添加上传的目录  当前目录   建立当前文件夹下所有的文件，为准备上传的文件</span><br><span class="line">[root@jmpserver asm-project1]# git add .</span><br><span class="line"></span><br><span class="line">5、提交上传的备注说明</span><br><span class="line">[root@jmpserver asm-project1]# git commit -m <span class="string">&#x27;v01-tes&#x27;</span></span><br><span class="line">[master 8305e9e] v01-tes</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br><span class="line"> create mode 100644 index.html</span><br><span class="line"> </span><br><span class="line">6、上传</span><br><span class="line">[root@jmpserver asm-project1]# git push -u origin master</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622141641454.png" alt="image-20240622141641454" style="zoom:80%;" /></p>
<h2 id="7-搭建持续集成引擎Jenkins"><a href="#7-搭建持续集成引擎Jenkins" class="headerlink" title="7. 搭建持续集成引擎Jenkins"></a>7. 搭建持续集成引擎Jenkins</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CI</span>  (continuous integration-<span class="keyword">Cl</span>)  持续集成    代码合并，构建，部署，测试都在一起，不断的执行的过程，并对结构反馈。</span><br><span class="line"><span class="keyword">CD</span>  (continuous Deloyments )    持续交付     把代码部署到测试环境，预生产环境。</span><br><span class="line"><span class="keyword">CD</span>  (continous Delivery )       持续部署      将最终的产品发布到生产环境，给用户使用。</span><br></pre></td></tr></table></figure>
<p>开发(git) —&gt;git主库—&gt;jenkins(git+jdk+tomcat+maven打包+测试）—&gt;发布到tomcat服务器 </p>
<p> Jenkins是帮我们将代码进行统一的编译打包、还可以放到tomcat容器中进行发布。<br>意思是我们通过配置，将以前：编译、打包、上传、部署到Tomcat中的过程交由Jenkins，Jenkins通过给定的代码地址URL，将代码拉取到其“宿主服务器”（Jenkins的安装位置），进行编译、打包和发布到web容器中。</p>
<p>环境准备：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>主机名</th>
<th>ip</th>
<th>角色</th>
</tr>
</thead>
<tbody>
<tr>
<td>jumpsever</td>
<td>10.0.0.74 / 172.16.1.74</td>
<td>gitlab      内存给3G以上 不然运行比较缓慢 (我已经部署好了)</td>
</tr>
<tr>
<td>jenkins</td>
<td>10.0.0.73 / 172.16.1.73</td>
<td>部署jenkins</td>
</tr>
<tr>
<td>web01</td>
<td>10.0.0.7 / 172.16.1.7</td>
<td>充当业务网站服务器</td>
</tr>
</tbody>
</table>
</div>
<p><strong>1、部署jenkins需要的环境</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">下载 maven3.8.8 包</span><br><span class="line">wget https://mirrors.cnnic.cn/apache/maven/maven-3/3.8.8/binaries/apache-maven-3.8.8-bin.tar.gz</span><br><span class="line">tar -zxvf apache-maven-3.8.8-bin.tar.gz -C /usr/local/</span><br><span class="line"><span class="built_in">mv</span>        /usr/local/apache-maven-3.8.8/       /usr/local/maven</span><br><span class="line"></span><br><span class="line">----------------------1、部署jenkins需要的环境（maven）-----</span><br><span class="line">1、获取包 我已经提前准备好了直接上传到服务器</span><br><span class="line">[root@jenkins ~]# rz</span><br><span class="line">rz waiting to receive.**</span><br><span class="line">[root@jenkins ~]# ll</span><br><span class="line">-rw-rw-rw-  1 root root 518668731 Mar 12 20:55 7.jenkins2.42_??Ƶ????.zip</span><br><span class="line">[root@jenkins ~]# unzip 7.jenkins2.42_��Ƶ����.zip</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# tar xf apache-maven-3.8.8-bin.tar.gz  -C /usr/local/</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# ll /usr/local/</span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x  6 root root 99 Jun 22 23:17 apache-maven-3.8.8</span><br><span class="line">名字有点长，可以改一下名字</span><br><span class="line">[root@jenkins ~]# <span class="built_in">mv</span> /usr/local/apache-maven-3.8.8 /usr/local/maven</span><br><span class="line"></span><br><span class="line">2、配置环境变量 建立一个新文件存放maven用的环境变量</span><br><span class="line">[root@jenkins ~]# vim /etc/profile.d/jenkins_tools.sh</span><br><span class="line"><span class="built_in">export</span> M2_HOME=/usr/local/maven</span><br><span class="line"><span class="built_in">export</span> M2=<span class="variable">$M2_HOME</span>/bin</span><br><span class="line">PATH=<span class="variable">$M2</span>:<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/bin:/usr/local/git/bin</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> MAVEN_HOME=/usr/local/maven</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;MAVEN_HOME&#125;</span>/bin:<span class="variable">$PATH</span> </span><br><span class="line"></span><br><span class="line">让配置文件生效</span><br><span class="line">[root@jenkins ~]# <span class="built_in">source</span> /etc/profile.d/jenkins_tools.sh </span><br><span class="line"></span><br><span class="line"><span class="comment">###测试的maven的版本，这里先不测试，因为maven需要依赖java等后面安装了java再测试</span></span><br><span class="line">[root@jenkins ~]# mvn --version</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line">------------------------2、部署jenkins需要的环境（git）-----</span><br><span class="line">1、安装依赖包</span><br><span class="line">[root@jenkins ~]# yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel gcc perl-ExtUtils-MakeMaker  fontconfig  -y</span><br><span class="line"></span><br><span class="line">2、git官网下载最新的版本GIT</span><br><span class="line">[root@jenkins ~]# wget https://mirrors.edge.kernel.org/pub/software/scm/git/git-2.9.5.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment">##这里的git我使用的是提前下载好的</span></span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# tar xf git-2.9.5.tar.gz </span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# ll</span><br><span class="line">drwxrwxr-x 21 root root     12288 Aug 10  2017 git-2.9.5</span><br><span class="line"></span><br><span class="line">3、修改环境变量</span><br><span class="line">[root@jenkins ~]# vim /etc/bashrc </span><br><span class="line">在最后一行加入环境变量</span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/bin:/usr/local/git/bin</span><br><span class="line">[root@jenkins ~]# <span class="built_in">source</span> /etc/bashrc </span><br><span class="line"></span><br><span class="line">3、进入git安装包的目录 编译安装</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# <span class="built_in">cd</span> git-2.9.5/</span><br><span class="line"></span><br><span class="line">编译源码包  告诉他把使用git工具的功能都启动&amp;&amp;指定/usr/local/git作为安装位置</span><br><span class="line">[root@jenkins git-2.9.5]#  make prefix=/usr/local/git all &amp;&amp; make prefix=/usr/local/git install</span><br><span class="line"></span><br><span class="line">4、测试是否安装成功</span><br><span class="line">[root@jenkins git-2.9.5]# git --version</span><br><span class="line">git version 1.8.3.1</span><br><span class="line">发现版本是1.83  因为centos 7使用yum预先安装了git </span><br><span class="line"></span><br><span class="line">[root@jenkins git-2.9.5]# yum list| grep git.x86</span><br><span class="line">git.x86_64                               1.8.3.1-25.el7_9              @updates </span><br><span class="line"></span><br><span class="line">5、把使用yum安装的git删除，</span><br><span class="line">[root@jenkins git-2.9.5]# yum remove -y git.x86_64</span><br><span class="line">移除的时候环境变量会被取消，需要在让刚刚写的环境变量生效一下</span><br><span class="line">[root@jenkins git-2.9.5]# <span class="built_in">source</span> /etc/bashrc </span><br><span class="line">[root@jenkins git-2.9.5]# git --version</span><br><span class="line">git version 2.9.5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------------------3、部署jenkins需要的环境（Java  tomact）-----</span><br><span class="line">1、安装JDK  我也是提前准备好的 直接上传到服务器           jdk是java</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# ll</span><br><span class="line">-rw-r--r--  1 root root 168905265 Aug  7  2023 jdk-11.0.16_linux-x64_bin.tar.gz</span><br><span class="line"></span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# tar xf jdk-11.0.16_linux-x64_bin.tar.gz </span><br><span class="line">解压出jdk-11.0.16</span><br><span class="line">drwxr-xr-x  9 root root       126 Jun 23 00:00 jdk-11.0.16</span><br><span class="line"></span><br><span class="line">2、上传tomcat 9 解压</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# tar xf apache-tomcat-9.0.79.tar.gz </span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# ll</span><br><span class="line">drwxr-xr-x  9 root root       220 Jun 23 00:01 apache-tomcat-9.0.79</span><br><span class="line"></span><br><span class="line">3、由于我都是在家目录里面解压的 家目录里面不适合放源代码，需要移动源代码</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# <span class="built_in">mv</span> jdk-11.0.16 /usr/local/java &amp;&amp; <span class="built_in">mv</span> apache-tomcat-9.0.79 /usr/local/tomcat</span><br><span class="line"></span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# <span class="built_in">ls</span> /usr/local/</span><br><span class="line">bin  games  include  lib    libexec  sbin   src</span><br><span class="line">etc  git    java     liba64  maven    share  tomcat</span><br><span class="line"></span><br><span class="line">4、处理环境变量</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# vim /etc/profile.d/java.sh</span><br><span class="line">TOMCAT_HOME=/usr/local/tomcat                 <span class="comment">#tomcat的家目录</span></span><br><span class="line">JAVA_HOME=/usr/local/java                     <span class="comment">#Java的家目录</span></span><br><span class="line">PATH=<span class="variable">$TOMCAT_HOME</span>/bin:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span>    <span class="comment">#可执行的路径</span></span><br><span class="line"><span class="built_in">export</span>    TOMCAT_HOME   JAVA_HOME   PATH</span><br><span class="line"></span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# <span class="built_in">source</span> /etc/profile.d/java.sh </span><br><span class="line"></span><br><span class="line">5、测试java maven的版本</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# java --version</span><br><span class="line">java 11.0.16 2022-07-19 LTS</span><br><span class="line">Java(TM) SE Runtime Environment 18.9 (build 11.0.16+11-LTS-199)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.16+11-LTS-199, mixed mode)</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# mvn --version</span><br><span class="line">Apache Maven 3.8.8 (4c87b05d9aedce574290d1acc98575ed5eb6cd39)</span><br><span class="line">Maven home: /usr/local/maven</span><br><span class="line">Java version: 11.0.16, vendor: Oracle Corporation, runtime: /usr/local/java</span><br><span class="line">Default locale: en_US, platform encoding: UTF-8</span><br><span class="line">OS name: <span class="string">&quot;linux&quot;</span>, version: <span class="string">&quot;3.10.0-957.el7.x86_64&quot;</span>, <span class="built_in">arch</span>: <span class="string">&quot;amd64&quot;</span>, family: <span class="string">&quot;unix&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>2、安装jenkins</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">官网下载jenkins:   http://updates.jenkins-ci.org/download/war/</span><br><span class="line"><span class="string">&quot;下载2.422&quot;</span>  我这里用的是2.422</span><br><span class="line"></span><br><span class="line">1、上传jenkins</span><br><span class="line"></span><br><span class="line">2、清理tomcat默认位置环境 把jenkins放到网站主目录</span><br><span class="line">[root@jenkins ~]# <span class="built_in">rm</span> -rf /usr/local/tomcat/webapps/*</span><br><span class="line"></span><br><span class="line">[root@jenkins ~]# <span class="built_in">cp</span> jenkins.war /usr/local/tomcat/webapps/</span><br><span class="line"></span><br><span class="line">3、启动tomcat,并页面访问</span><br><span class="line">[root@jenkins ~]# /usr/local/tomcat/bin/startup.sh</span><br><span class="line"></span><br><span class="line">[root@jenkins ~]# netstat -lntup| grep 8080</span><br><span class="line">tcp6       0      0 :::8080                 :::*                    LISTEN      13990/java  </span><br><span class="line"></span><br><span class="line">4、访问页面</span><br><span class="line">我用的服务器ip是   10.0.0.73</span><br><span class="line">在浏览器输入 10.0.0.73:8080/jenkins </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">如果有其他错误,请查询tomcat的错误日志.</span><br></pre></td></tr></table></figure>
<p><strong>3、前台配置jenkins</strong></p>
<ul>
<li>为了安全考虑，首先需要解锁Jenkins</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622170511138.png" alt="image-20240622170511138"></p>
<ul>
<li>.选择suggested的插件进行下载</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622175903771.png" alt="image-20240622175903771"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">点击进去左边的页面进行插件安装，比较缓慢，因为从国外的源进行下载，下载时间比较长，可以做优化</span><br><span class="line">1、</span><br><span class="line">[root@jenkins webapps]# vim ~/.jenkins/hudson.model.UpdateCenter.xml </span><br><span class="line">把下载地址换成：</span><br><span class="line">http://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</span><br><span class="line"></span><br><span class="line">2、</span><br><span class="line">[root@jenkins webapps]# vim ~/.jenkins/updates/default.json </span><br><span class="line">替换命令vim编辑器替换。需要在末行模式输入冒号：</span><br><span class="line">% s/www.google.com/www.baidu.com/g</span><br><span class="line">% s/updates.jenkins.io\/download/mirrors.tuna.tsinghua.edu.cn\/jenkins/g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">旧版： http://updates.jenkins-ci.org/download 替换成 https://mirrors.tuna.tsinghua.edu.cn/jenkins </span><br><span class="line">新版：https://updates.jenkins.io/download 替换成 https://mirrors.tuna.tsinghua.edu.cn/jenkins </span><br><span class="line"></span><br><span class="line">修改完以后，重启Jenkins服务再输入密码，继续安装，速度贼快。</span><br><span class="line">重启方法：在浏览器里面ip:端口/jenkins/restart</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622180929971.png" alt="image-20240622180929971"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins webapps]# <span class="built_in">cat</span> /root/.jenkins/secrets/initialAdminPassword</span><br><span class="line">5fc9adf62f2c45d5bcf330cbb261f948</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622181049925.png" alt="image-20240622181049925"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622181113618.png" alt="image-20240622181113618"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">因为网速原因，插件可能下载失败，没关系，把他们记录下来，比如下图的两个插件，点击继续，进去之后手动重新安装未安装好的插件</span><br><span class="line">也可以重试，继续下载安装。</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622181858251.png" alt="image-20240622181858251"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">如果下载比较慢，有的插件下载失败，我不想继续等那么久一直下载，我有一个jenkins的插件包，我直接上传使用jenkins_plugins.tar</span><br><span class="line">需要先安装bzip2才可以使用tar命令解压</span><br><span class="line">1、安装bzip2</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# yum -y install bzip2</span><br><span class="line"></span><br><span class="line">2、解压</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# tar xf jenkins_plugins.tar </span><br><span class="line"></span><br><span class="line">3、解压之后会看到一个新的root目录 进入plugins目录</span><br><span class="line">[root@jenkins jenkins2.42-视频工具]# <span class="built_in">cd</span> root/</span><br><span class="line">[root@jenkins root]# <span class="built_in">ls</span> -a</span><br><span class="line">.  ..  .jenkins</span><br><span class="line">[root@jenkins root]# <span class="built_in">cd</span> .jenkins/</span><br><span class="line">[root@jenkins .jenkins]# <span class="built_in">ls</span></span><br><span class="line">plugins</span><br><span class="line">[root@jenkins .jenkins]# <span class="built_in">cd</span> plugins/</span><br><span class="line"></span><br><span class="line">4、进入plugins目录之后，把里面的所有内容全部复制到/root/.jenkins/ plugins</span><br><span class="line">[root@jenkins plugins]# \<span class="built_in">cp</span>  * /root/.jenkins/plugins/</span><br><span class="line"></span><br><span class="line">\<span class="built_in">cp</span>  强制覆盖</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622183932494.png" alt="image-20240622183932494"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622184633650.png" alt="image-20240622184633650"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622184746431.png" alt="image-20240622184746431"></p>
<ul>
<li>点击恢复之后会调转到创建用户的页面</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622185047160.png" alt="image-20240622185047160"></p>
<ul>
<li>jenkins的地址分享</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622185136016.png" alt="image-20240622185136016"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622185153370.png" alt="image-20240622185153370"></p>
<p>如果这个页面过一会消失了。并且经常空白。可能需要你登录了。换个浏览器，打开相同的地址就会出现认证页面。</p>
<ul>
<li><p>欢迎页面</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622185503414.png" alt="image-20240622185503414"></p>
</li>
</ul>
<p><strong>4、系统配置   为了告诉jenkins我们所需要调用的各项组件的位置</strong></p>
<ul>
<li><p>全局变量设置</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622190223708.png" alt="image-20240622190223708"></p>
</li>
</ul>
<p>一直往下滑</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622190320985.png" alt="image-20240622190320985"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622190538124.png" alt="image-20240622190538124"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622190834276.png" alt="image-20240622190834276"></p>
<ul>
<li>全局工具配置</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622191009901.png" alt="image-20240622191009901"></p>
<p>1、maven配置</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622191356035.png" alt="image-20240622191356035"></p>
<p>2、添加JDK工具</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622191650753.png" alt="image-20240622191650753"></p>
<p>3、添加Git工具</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622191901295.png" alt="image-20240622191901295"></p>
<p>4、添加maven工具</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622192119718.png" alt="image-20240622192119718"></p>
<p>5、SSH设置  告诉jenkins,业务主机的信息</p>
<p>我的jenkins主机是10.0.0.73           业务主机web01是10.0.0.7</p>
<p>我要在jenkins上配web01的密钥</p>
<p>一、jenkins服务器准备密钥认证</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins plugins]# ssh-keygen</span><br><span class="line"></span><br><span class="line">把密钥发给web01</span><br><span class="line">[root@jenkins plugins]# ssh-copy-id 172.16.1.7</span><br></pre></td></tr></table></figure>
<p>二、在jenkins上配置ssh信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">1、查看密钥</span><br><span class="line">[root@jenkins plugins]# vim ~/.ssh/id_rsa</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEowIBAAKCAQEAycvppyjh9MVJkct7AQQDy+rILhTgeYnNuDFoRCP8QWvrdMb1</span><br><span class="line">FUmRD4DuguVkIvMvf+X+PrE+4P1MN1uAvQDSSTwI0TyeCqlYcMr9oezbGJiY8KdS</span><br><span class="line">1UAkBLU2hTRCa3twufotH1Myi/QD4+wQnzrqss9M0R6K/WK3/Rr62A0Gf36Pd5+s</span><br><span class="line">s7lXm+JOolRx0NSQaAJLrbquX5VmjmKuqAAsGRXL9JSP4nolJrns4oLRevW9TM0j</span><br><span class="line">MXMSnsHTjSBj5ZzjzTtLxO2XMtsJOutZ5AP760gYwL/IDow5mslCGrFXm7ginPaP</span><br><span class="line">X9BxtKl71v0g6yRKhTU5ODHEKpn2QACgfVqSiQIDAQABAoIBAAx7lqqGduPDSHfC</span><br><span class="line">VIuNigaVMWjYVcJu6dDZDZAZgcMyP9BrdkGo2VZSLW7fbcBTtr58pauPH0qfoJVU</span><br><span class="line">DbSjVl69XfZDf6s9KoFfrSzVEACHf/5y+0bBvvijlQnMX8dyTVjTxvLHHLtXjt4M</span><br><span class="line">fkK7TEVfWWseLo7aCnOXtaijtaExQLXXrDszWQ7AYO3V2FlFSmr/jalvQpsaTPV1</span><br><span class="line">4qmgudsgW6suHmj1UEOOTmCdkMrvEXxtN2fCDkigA+sFnsS+yyYO8pWqq+DJ6Qm6</span><br><span class="line">WeGuTEbTpxQN3WQCb1BdBxAR/8mb5o2g6Vu2OJW93lXHOxtc21yD795EmQnGd2by</span><br><span class="line">GzY6Z1kCgYEA/ooDOOZHo+EJaQB1s2sioHTqIdWknoKk+ypPWfoQoB1Qp6fa/EAy</span><br><span class="line">9caqICnKBBZ3KDXcIlOSs3Ax/1PVHz0XS5XfYcVA73Z54Q2T57IBZoOxzhiOT4s5</span><br><span class="line">b1jfPRmaJRaw4IB7db98o3DdVUO8Np/0pL4OFx24NgiRQVeId71W5zMCgYEAyvRo</span><br><span class="line">KVwOy/jkyfXOsVGCuP41zRTGnq4GxRNR1stGWBXmTqNAG1VBbLMgujlrjBEFsQhf</span><br><span class="line">harjJc0LDwMELWWc90M5hW3ZxXMD9lA80o5yW32RHpk7Gq8IUZhnl9DnuCodmisq</span><br><span class="line">NX+EaRrZaCUGgtISTSiSFLQFJ68jBynLgQJX71MCgYEAtX+dupXhYYaWWiv8wXnU</span><br><span class="line">UAvt40BeyLQphfruaB86eaFNoK69JH92lvAY4SRLK00FnEODe2qSQabvz7tsTYEX</span><br><span class="line">Oktc5G9t1RJq58HxxBWWkA253FaAK1IAG1iInh3CX03lw795yUVIT5asDB9ndp/q</span><br><span class="line">JwpqK6uCbez//lK3OYJmFCcCgYBa6aKjLE6ghgyOf2KoQXgKQC1/gVf7ir8TlrTp</span><br><span class="line">P8Nx/9Vb0nsMA2O8On1ljgUkCBgBllubt9Hqg+/5OIOthkAK7v0cTPnpHb1fn8+v</span><br><span class="line">Dgoh+5x/FWrJaDCUxG1bL0QtVghOoBlXP5jjsBhFM5i4DzwNfif5yC4q+aP6OHml</span><br><span class="line">f5Q+awKBgEjRomtdbcHgqrT8vj8ncIbTjw5UG3AzHkPuhElsg/2EdEpTlp5DRvvJ</span><br><span class="line">65ldrVeexM18O2wwSWs9gUqMVjc8OFM63xSU8/0NXS+a8c+nv27P/oLr4d0hEf5W</span><br><span class="line">r9xbsqiySxP6yKNuOxmm6cMzBd1g0nurK0vEbV1z+2DF1tJxTLN2</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line"></span><br><span class="line">2、进入jenkins系统设置</span><br><span class="line"></span><br><span class="line">3、粘贴到Jenkins</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622193759720.png" alt="image-20240622193759720"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622194343141.png" alt="image-20240622194343141"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622194524805.png" alt="image-20240622194524805"></p>
<p><strong>5、插件管理</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622195643235.png" alt="image-20240622195643235"></p>
<p>（1）Maven Integration plugin 安装此插件才能构建maven项目</p>
<p>（2）Deploy to container Plugin 安装此插件，才能将打好的包部署到tomcat上</p>
<p>(3) 安装git相关2个插件   GitHub Authentication 、GitHub Branch Source</p>
<p>(4)安装插件：Publish Over SSH</p>
<p>上述插件我在已安装的地方搜索一下都已经安装过了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622200517723.png" alt="image-20240622200517723"></p>
<p>maven优化</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">jenkins开始构建任务的时候，他会更新maven的组件，更新过程中上传下载比较慢，可以配置国内maven镜像</span><br><span class="line"></span><br><span class="line">就是把国外的进行路径换成国内的镜像</span><br><span class="line">[root@jenkins plugins]# vim /usr/local/maven/conf/settings.xml </span><br><span class="line">末行模式输入/0.0.0.0进行搜索</span><br><span class="line"></span><br><span class="line">添加如下内容</span><br><span class="line">    &lt;mirror&gt;</span><br><span class="line">      &lt;<span class="built_in">id</span>&gt;central&lt;/id&gt;</span><br><span class="line">      &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;</span><br><span class="line">      &lt;name&gt;aliyun maven&lt;/name&gt;</span><br><span class="line">      &lt;url&gt;https://maven.aliyun.com/repository/public&lt;/url&gt;</span><br><span class="line">    &lt;/mirror&gt; </span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622201843765.png" alt="image-20240622201843765"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622202100262.png" alt="image-20240622202100262"></p>
<p><strong>6、jenkins+maven+gitlab+tomcat  自动化构建打包、部署</strong></p>
<p>jenkins调用git下载源代码，利用maveen打包源代码， ssh推送源代码，结合生产服务器tomcat上线源代码</p>
<p>1、创建一个Maven工程</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622205526573.png" alt="image-20240622205526573"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622205644617.png" alt="image-20240622205644617"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622210034140.png" alt="image-20240622210034140"></p>
<p>2、源码管理，选择版本控制器和仓库地址</p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/newrain001/easy-springmvc-maven.git">https://gitee.com/newrain001/easy-springmvc-maven.git</a>   互联网仓库</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622210527474.png" alt="image-20240622210527474"></p>
<p>如果是使用的gitlab,需要做jenkins和gitlab的身份认证，就是把密钥互相拷贝一下</p>
<p>3、设置触发器 就是啥时候开始打包开始推</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622210923201.png" alt="image-20240622210923201"></p>
<p>4、设置构建，设置打包的程序（编译打包）</p>
<p>手动添加Goals and options       clean package -Dmaven.test.skip=true  意思是装完之后把这个包清一下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622211203160.png" alt="image-20240622211203160"></p>
<p>5、构建后操作（打完包之后做的事，开始往外推送）</p>
<p>在构建后设置中 选择：(send build artifacts over ssh)通过SSH发送构建工件 </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622211434330.png" alt="image-20240622211434330"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622211506754.png" alt="image-20240622211506754"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">推送什么，传输什么，源文件target/*.war  是Jenkins服务器root目录里面有一个文件夹，就是maven打包干活的地方</span><br><span class="line"></span><br><span class="line">当你把包推过去之后你还有什么事要做</span><br><span class="line">tomcat（web01 10.0.0.7）在接收到源码之后的自定义动作。</span><br><span class="line">比如：将源码拷贝到网站的主目录（/jenkins）,并执行一些其他操作如重启服务器等（或创建文件<span class="built_in">touch</span>）（需要后台创建）</span><br><span class="line">但是我没有安装网站，我就直接推过去测试创建文件</span><br><span class="line">[root@web01 ~]# <span class="built_in">mkdir</span> -p /jenkins/&#123;sh,war&#125;</span><br><span class="line">[root@web01 ~]# vim /jenkins/sh/deploy.sh</span><br><span class="line"><span class="built_in">touch</span> /tmp/&#123;1..10&#125;.txt</span><br><span class="line"><span class="comment">#这里一般都是写重启网站的命令：systemctl restart nginx</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@web01 ~]#  <span class="built_in">chmod</span> +x /jenkins/sh/deploy.sh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">clean package -Dmaven.test.skip=<span class="literal">true</span></span><br><span class="line">target/*.war</span><br><span class="line">target</span><br><span class="line">/jenkins/war</span><br><span class="line">/jenkins/sh/deploy.sh</span><br><span class="line"></span><br><span class="line"> https://gitee.com/fanjialong/cicd-demo48.git</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622215052624.png" alt="image-20240622215052624"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622213858886.png" alt="image-20240622213858886"></p>
<p>6、执行构建</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622231614568.png" alt="image-20240622231614568"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622231539741.png" alt="image-20240622231539741"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240622231640163.png" alt="image-20240622231640163"></p>
<p>显示成功，去web01机器验证tmp是否存在创建的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@web01 ~]# <span class="built_in">ls</span> /tmp/</span><br><span class="line">10.txt  4.txt  8.txt                        vmware-root_6028-726237631</span><br><span class="line">1.txt   5.txt  9.txt                        vmware-root_6043-1723079798</span><br><span class="line">2.txt   6.txt  hsperfdata_root              vmware-root_6073-1715281356</span><br><span class="line">3.txt   7.txt  vmware-root_5981-1723210961  vmware-root_6096-1002483780</span><br><span class="line"></span><br><span class="line">[root@web01 ~]# <span class="built_in">ls</span> /jenkins/war/</span><br><span class="line">easy-springmvc-maven.war</span><br></pre></td></tr></table></figure>
<h2 id="9-jumpserver部署"><a href="#9-jumpserver部署" class="headerlink" title="9 . jumpserver部署"></a>9 . jumpserver部署</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">1、从飞致云社区 下载最新的 linux/amd64 离线包, 并上传到部署服务器的 /opt 目录</span><br><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line">curl -sSL https://resource.fit2cloud.com/jumpserver/jumpserver/releases/latest/download/quick_start.sh | bash</span><br><span class="line"></span><br><span class="line">2、安装完成后 JumpServer 配置文件路径为： /opt/jumpserver/config/config.txt</span><br><span class="line"></span><br><span class="line">3、</span><br><span class="line"><span class="built_in">cd</span> /opt/jumpserver-installer-v3.10.10</span><br><span class="line"><span class="comment"># 启动</span></span><br><span class="line">./jmsctl.sh start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止</span></span><br><span class="line">./jmsctl.sh down</span><br><span class="line"></span><br><span class="line"><span class="comment"># 卸载</span></span><br><span class="line">./jmsctl.sh uninstall</span><br><span class="line"></span><br><span class="line"><span class="comment"># 帮助</span></span><br><span class="line">./jmsctl.sh -h</span><br><span class="line"></span><br><span class="line">4、安装成功后，通过浏览器访问登录 JumpServer</span><br><span class="line">地址: http://&lt;JumpServer服务器IP地址&gt;:&lt;服务运行端口&gt;</span><br><span class="line">用户名: admin</span><br><span class="line">密码: admin    登陆之后需要改密码</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240623130556168.png" alt="image-20240623130556168"></p>
<h2 id="10-部署ELK"><a href="#10-部署ELK" class="headerlink" title="10. 部署ELK"></a>10. 部署ELK</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ELK :ELKstack是的elk的集群名字</span><br><span class="line">E: Elasticserch （这是一个数据库，搜索引擎数据库）也简称es</span><br><span class="line">L:</span><br><span class="line">K:</span><br><span class="line">F:</span><br></pre></td></tr></table></figure>
<p>ELK是指Elasticsearch + Logstash + Kibaba三个组件的组合。<br>　　在这个系统中，Elasticsearch主要充当一个全文检索和分析引擎，主要用于存储日志，Logstash是一款分布式日志收集系统，用于数据解析，Kibana可以为这个平台提供可视化的Web界面。展示数据。是一套集中的可视化可交互便捷的管理日志，分析日志的工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">版本说明：</span><br><span class="line">Elasticsearch、Logstash、Kibana、Filebeat安装的版本号必须全部一致,不然会出现kibana无法显示web页面。</span><br><span class="line"></span><br><span class="line">ELK工作演示图：</span><br><span class="line"></span><br><span class="line">Filebeat在APP Server端收集日志</span><br><span class="line">Logstash处理过滤Filebeat收集过来的日志，哪台机器的日志需要收集，就安装在哪台机器上</span><br><span class="line">Elasticsearch存储Logstash提供的处理之后的日志，用以检索、统计</span><br><span class="line">Kibana提供web页面，将Elasticsearch的数据可视化的展示出来</span><br></pre></td></tr></table></figure>
<p>安装JDK-11.0.16    安装elasticsearch7.13.2       安装logstash-7.13.2             安装kibana-7.13.2</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>主机名</th>
<th>ip</th>
<th>节点类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>elk1</td>
<td>10.0.0.76 /  172.16.1.76</td>
<td>数据，主节点(安装elasticsearch、logstash、kibana)</td>
</tr>
<tr>
<td>elk2</td>
<td>10.0.0.77 /  172.16.1.77</td>
<td>数据节点(安装elasticsearch)</td>
</tr>
<tr>
<td>elk3</td>
<td>10.0.0.78 /  172.16.1.78</td>
<td>数据节点(安装elasticsearch)</td>
</tr>
</tbody>
</table>
</div>
<p><strong>环境准备</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1、3台机器时间需要同步</span><br><span class="line">[root@elk1 ~]#  yum install -y ntpdate</span><br><span class="line">[root@elk2 ~]#  yum install -y ntpdate</span><br><span class="line">[root@elk3 ~]#  yum install -y ntpdate</span><br><span class="line"></span><br><span class="line"><span class="comment">#Ansible: ntp同步网络时间</span></span><br><span class="line">* * * * * /usr/sbin/ntpdate cn.pool.ntp.org &amp;&gt;/dev/null</span><br></pre></td></tr></table></figure>
<p><strong>1、部署Elasticsearch</strong></p>
<p>1、安装jdk-11.0.16</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1、3台机器准备rpm包</span><br><span class="line">[root@elk1 elk]# <span class="built_in">ls</span></span><br><span class="line">elasticsearch-7.13.2-x86_64.rpm   kibana-7.13.2-linux-x86_64.tar.gz</span><br><span class="line">jdk-11.0.16_linux-x64_bin.tar.gz  logstash-7.13.2-linux-x86_64.tar.gz</span><br><span class="line"></span><br><span class="line">2、3台机器安装jdk-11.0.16</span><br><span class="line">[root@elk1 elk]# <span class="built_in">mkdir</span> /usr/local/jdk</span><br><span class="line">[root@elk1 ~]#  <span class="built_in">mv</span> jdk-11.0.16_linux-x64_bin.tar.gz  /usr/local/jdk/</span><br><span class="line">[root@elk1 ~]# <span class="built_in">cd</span> /usr/local/jdk/</span><br><span class="line">[root@elk1 jdk]# tar xf jdk-11.0.16_linux-x64_bin.tar.gz </span><br><span class="line"></span><br><span class="line">3、3台机器配置环境变量</span><br><span class="line">[root@elk1 ~]#  vim /etc/profile</span><br><span class="line"><span class="comment">#set java environment</span></span><br><span class="line">JAVA_HOME=/usr/local/jdk/jdk-11.0.16</span><br><span class="line">CLASSPATH=<span class="variable">$JAVA_HOME</span>/lib/</span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH JAVA_HOME CLASSPATH</span><br><span class="line"></span><br><span class="line">4、使环境变量生效</span><br><span class="line">[root@elk1 jdk]# <span class="built_in">source</span> /etc/profile</span><br><span class="line">[root@elk2 jdk]# <span class="built_in">source</span> /etc/profile</span><br><span class="line">[root@elk3 jdk]# <span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line">5、检查JDK是否安装成功(出现如下信息说明安装成功)</span><br><span class="line">[root@elk1 jdk]# java -version</span><br><span class="line">java version <span class="string">&quot;11.0.16&quot;</span> 2022-07-19 LTS</span><br><span class="line">Java(TM) SE Runtime Environment 18.9 (build 11.0.16+11-LTS-199)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.16+11-LTS-199, mixed mode)</span><br></pre></td></tr></table></figure>
<p>2、安装Elasticsearch（简称ES）集群</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">1、3台机器操作安装elasticsearch-7.13.2-x86_64.rpm</span><br><span class="line">[root@elk1 elk]# <span class="built_in">mkdir</span> /usr/local/elk</span><br><span class="line">[root@elk1 ~]#  <span class="built_in">mv</span> elasticsearch-7.13.2-x86_64.rpm  /usr/local/elk</span><br><span class="line">[root@elk1 ~]# <span class="built_in">cd</span> /usr/local/elk</span><br><span class="line">[root@elk1 elk]# yum -y install elasticsearch-7.13.2-x86_64.rpm </span><br><span class="line"></span><br><span class="line">2、创建用户及授权</span><br><span class="line">Elasticsearch要求以非root身份启动，在每个节点创建用户组和用户</span><br><span class="line">[root@elk3 elk]# groupadd elastic;useradd elastic -g elastic</span><br><span class="line">[root@elk3 elk]# <span class="built_in">id</span> elastic</span><br><span class="line">uid=1000(elastic) gid=1000(elastic) <span class="built_in">groups</span>=1000(elastic)</span><br><span class="line"></span><br><span class="line">3、在每个节点创建数据data和日志logs目录</span><br><span class="line">[root@elk1 elk]# <span class="built_in">mkdir</span> -p  /data/elk/&#123;data,logs&#125;;<span class="built_in">chown</span> -R elastic.elastic /data;ll /data/</span><br><span class="line"></span><br><span class="line">4、es集群操作，我们需要去设定他们之间的集群关系</span><br><span class="line">elk1 节点 设置的内容如下：</span><br><span class="line">[root@elk1 elk]# grep <span class="string">&quot;^[a-Z]&quot;</span> /etc/elasticsearch/elasticsearch.yml</span><br><span class="line">cluster.name: elk       <span class="comment">#集群名字</span></span><br><span class="line">node.name: elk1         <span class="comment">#这行没有，直接添加在node.name: ela1 的下面就可以</span></span><br><span class="line">node.data: <span class="literal">true</span></span><br><span class="line">path.data: /data/elk/data</span><br><span class="line">path.logs: /data/elk/logs</span><br><span class="line">network.host: 0.0.0.0    <span class="comment">#只要是本机的Ip找我都可以</span></span><br><span class="line">http.port: 9200</span><br><span class="line">discovery.seed_hosts: [<span class="string">&quot;172.16.1.76&quot;</span>, <span class="string">&quot;172.16.1.77&quot;</span>, <span class="string">&quot;172.16.1.78&quot;</span>]</span><br><span class="line">cluster.initial_master_nodes: [<span class="string">&quot;elk1&quot;</span>, <span class="string">&quot;elk2&quot;</span>, <span class="string">&quot;elk3&quot;</span>]   <span class="comment">#可选的主节点都有谁</span></span><br><span class="line"></span><br><span class="line">elk2 elk3机器都是一样的写法，所以直接scp过去</span><br><span class="line">[root@elk1 elk]# scp /etc/elasticsearch/elasticsearch.yml 172.16.1.77:/etc/elasticsearch</span><br><span class="line">[root@elk1 elk]# scp /etc/elasticsearch/elasticsearch.yml 172.16.1.78:/etc/elasticsearch</span><br><span class="line"></span><br><span class="line">[root@elk2 elk]# vim /etc/elasticsearch/elasticsearch.yml </span><br><span class="line">node.name: elk2</span><br><span class="line">[root@elk3 elk]# vim /etc/elasticsearch/elasticsearch.yml </span><br><span class="line">node.name: elk3</span><br><span class="line"></span><br><span class="line"><span class="comment">##参数说明--------------------------------------------------------</span></span><br><span class="line">cluster.name 集群名称，各节点配成相同的集群名称。</span><br><span class="line">node.name 节点名称，各节点配置不同。</span><br><span class="line">node.data 指示节点是否为数据节点。数据节点包含并管理索引的一部分。</span><br><span class="line">path.data 数据存储目录。</span><br><span class="line">path.logs 日志存储目录。</span><br><span class="line">network.host 绑定节点IP。</span><br><span class="line">http.port 监听端口。</span><br><span class="line">discovery.seed_hosts 指定集群成员，用于主动发现他们， 所有成员都要写进来，包括自己，每个节点中应该写一样的信息</span><br><span class="line">cluster.initial_master_nodes 指定有资格成为 master 的节点</span><br><span class="line">http.cors.enabled 用于允许<span class="built_in">head</span>插件访问ES。</span><br><span class="line">http.cors.allow-origin 允许的源地址。</span><br><span class="line"></span><br><span class="line">注意: -</span><br><span class="line">当你为提供自定义设置时 network.host ，Elasticsearch会假设您正在从开发模式过渡到生产模式，并将许多系统启动检查从警告升级到异常。</span><br><span class="line">cluster.initial_master_nodes 中的节点名称需要和 node.name 的名称一致。</span><br><span class="line"><span class="comment">#---------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">4、3台机器设置elasticsearch的JVM最大最小内存限制</span><br><span class="line"><span class="comment">###    ！！！！！！！！！！！！！！坑在这里！！！！！！！！！！！</span></span><br><span class="line">[root@elk1 elk]#  vim /etc/elasticsearch/jvm.options</span><br><span class="line">-Xms1g</span><br><span class="line">-Xmx1g</span><br><span class="line">如果你的虚拟机只给了1G 这里就要改成512mb，（本人没亲自设置过，选择的下面的方法）</span><br><span class="line">如果你的虚拟机给了3G 这里就不用管（我直接给了虚拟机内存）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4、3台机器执行  启动</span><br><span class="line">[root@elk1 elk]# systemctl daemon-reload;systemctl <span class="built_in">enable</span> elasticsearch.service </span><br><span class="line">systemctl start elasticsearch.service </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="11"><a href="#11" class="headerlink" title="11."></a>11.</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">1【添加yum仓库】</span><br><span class="line"><span class="comment"># root执行</span></span><br><span class="line"><span class="comment"># 导入仓库密钥</span></span><br><span class="line">[root@elk1 ~]# rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加yum源</span></span><br><span class="line"><span class="comment"># 编辑文件 </span></span><br><span class="line">[root@elk1 ~]# vim /etc/elasticsearch/elasticsearch.yml +17</span><br><span class="line">[elasticsearch-7.x]</span><br><span class="line">name=Elasticsearch repository <span class="keyword">for</span> 7.x packages</span><br><span class="line">baseurl=https://artifacts.elastic.co/packages/7.x/yum</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch</span><br><span class="line">enabled=1</span><br><span class="line">autorefresh=1</span><br><span class="line"><span class="built_in">type</span>=rpm-md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新yum缓存</span></span><br><span class="line">[root@elk1 ~]# yum makecache</span><br><span class="line"></span><br><span class="line">2【安装es 】</span><br><span class="line">[root@elk1 ~]# yum install -y elasticsearch</span><br><span class="line"></span><br><span class="line">3【配置es 】</span><br><span class="line">[root@elk1 ~]# vim /etc/elasticsearch/elasticsearch.yml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 17行，设置集群名称</span></span><br><span class="line">cluster.name: my-cluster</span><br><span class="line"></span><br><span class="line"><span class="comment"># 23行，设置节点名称</span></span><br><span class="line">node.name: node-1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 56行，允许外网访问</span></span><br><span class="line">network.host: 0.0.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 74行，配置集群master节点</span></span><br><span class="line">cluster.initial_master_nodes: [<span class="string">&quot;node-1&quot;</span>]</span><br><span class="line"></span><br><span class="line">4【启动es 】</span><br><span class="line">[root@elk1 ~]# systemctl start elasticsearch;systemctl <span class="built_in">enable</span> elasticsearch</span><br><span class="line">[root@elk1 ~]# netstat -lntup |grep 9200</span><br><span class="line">tcp6       0      0 :::9200                 :::*                    LISTEN      7400/java  </span><br><span class="line"></span><br><span class="line">5、打开浏览器测试</span><br><span class="line">10.0.0.76:9200</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240624201722843.png" alt="image-20240624201722843"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1.2【安装Kibana】</span><br><span class="line">[root@elk1 ~]# vim /etc/kibana/kibana.yml</span><br><span class="line"> <span class="comment">#第2行</span></span><br><span class="line"> server.port: 5601</span><br><span class="line"> <span class="comment">#第7行</span></span><br><span class="line"> server.host: <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line"> [root@elk1 ~]# systemctl start kibana</span><br><span class="line"> </span><br><span class="line"> 打开浏览器测试</span><br><span class="line">10.0.0.76:5601</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240624203100864.png" alt="image-20240624203100864" style="zoom:67%;" /></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="12-需要自己调研"><a href="#12-需要自己调研" class="headerlink" title="12  需要自己调研"></a>12  需要自己调研</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">rabbitMQ，这个不能增删改查，我们不能手动放数据，先尝试一下能不能放数据</span><br><span class="line">postgreSQL</span><br><span class="line">1、安装</span><br><span class="line">2、数据的增删改查</span><br><span class="line">3、用户管理</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LVS</span><br><span class="line">TSDB 数据库</span><br><span class="line">你说的这个数据库我可能没有用过，我们公司之前用的是....如果贵公司用的是这个的话，我觉得数据库都是大同小异，我可以学</span><br><span class="line"></span><br><span class="line">淘宝用的tengine,是在nginx基础上做的二次开发，和nginx几乎一样，配置文件也是差不多的</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">项目经验:</span><br><span class="line">代码自动化发布</span><br><span class="line">项目需求:</span><br><span class="line">1.运维配合开发测试占用大量的时间</span><br><span class="line">2.快速实现CICD从而尽早发现代码或部署过程中存在的问题</span><br><span class="line">3.使用参数化构建进行线上发布降低出错率、实现秒级回滚</span><br><span class="line">4.发布结果通知相关人员</span><br><span class="line">实现项目:</span><br><span class="line">1.搭建Gitlab服务器并控制项目权限</span><br><span class="line">2.搭建并配置Jenkins服务器</span><br><span class="line">3.按项目需求创建</span><br><span class="line">TAG项目(为MASTER主干打标签)</span><br><span class="line">测试项目(快速CI CD及早发现问题并且配置自动触发不要运维干预)</span><br><span class="line">JAVA项目(jenkins集成mvn编译并发布测试环境)</span><br><span class="line">发布项目(利用tag标签进行线上发布和秒级回滚)</span><br><span class="line">4.搭建SonarQube代码质量检测平台(Jenkins集成Sonar进行自动化代码分析检测)</span><br><span class="line">5.搭建Nexus私服(java代码下载依赖快速编译)</span><br><span class="line">6.编写Jenkins-pipeline流水线(看板方式快速定位问题)</span><br><span class="line">7.Jenkins增加三台从节点实现分布式构建(提高项目的构建速度和稳定性)</span><br><span class="line">8.Jenkins集成第三方插件发送构建结果到运维开发组</span><br></pre></td></tr></table></figure>
<h2 id="13-redis的info获取信息"><a href="#13-redis的info获取信息" class="headerlink" title="13.redis的info获取信息"></a>13.redis的info获取信息</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看redis相关信息</span></span><br><span class="line">127.0.0.1:6379&gt; info</span><br><span class="line"><span class="comment">#服务端信息</span></span><br><span class="line"><span class="comment"># Server</span></span><br><span class="line"><span class="comment">#版本号</span></span><br><span class="line">redis_version:3.2.12</span><br><span class="line"><span class="comment">#redis版本控制安全hash算法</span></span><br><span class="line">redis_git_sha1:00000000</span><br><span class="line"><span class="comment">#redis版本控制脏数据</span></span><br><span class="line">redis_git_dirty:0</span><br><span class="line"><span class="comment">#redis建立id</span></span><br><span class="line">redis_build_id:3b947b91b7c31389</span><br><span class="line"><span class="comment">#运行模式：单机（如果是集群：cluster）</span></span><br><span class="line">redis_mode:standalone</span><br><span class="line"><span class="comment">#redis所在宿主机的操作系统</span></span><br><span class="line">os:Linux 2.6.32-431.el6.x86_64 x86_64</span><br><span class="line"><span class="comment">#架构（64位）</span></span><br><span class="line">arch_bits:64</span><br><span class="line"><span class="comment">#redis事件循环机制</span></span><br><span class="line">multiplexing_api:epoll</span><br><span class="line"><span class="comment">#GCC的版本</span></span><br><span class="line">gcc_version:4.4.7</span><br><span class="line"><span class="comment">#redis进程的pid</span></span><br><span class="line">process_id:33007</span><br><span class="line"><span class="comment">#redis服务器的随机标识符(用于sentinel和集群)</span></span><br><span class="line">run_id:46b07234cf763cab04d1b31433b94e31b68c6e26</span><br><span class="line"><span class="comment">#redis的端口</span></span><br><span class="line">tcp_port:6379</span><br><span class="line"><span class="comment">#redis服务器的运行时间（单位秒）</span></span><br><span class="line">uptime_in_seconds:318283</span><br><span class="line"><span class="comment">#redis服务器的运行时间（单位天）</span></span><br><span class="line">uptime_in_days:3</span><br><span class="line"><span class="comment">#redis内部调度（进行关闭timeout的客户端，删除过期key等等）频率，程序规定serverCron每秒运行10次</span></span><br><span class="line">hz:10</span><br><span class="line"><span class="comment">#自增的时钟，用于LRU管理,该时钟100ms(hz=10,因此每1000ms/10=100ms执行一次定时任务)更新一次</span></span><br><span class="line">lru_clock:13601047</span><br><span class="line"><span class="comment">#服务端运行命令路径</span></span><br><span class="line">executable:/application/redis-3.2.12/redis-server</span><br><span class="line"><span class="comment">#配置文件路径</span></span><br><span class="line">config_file:/etc/redis/6379/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="comment">#客户端信息</span></span><br><span class="line"><span class="comment"># Clients</span></span><br><span class="line"><span class="comment">#已连接客户端的数量(不包括通过slave的数量)</span></span><br><span class="line">connected_clients:2</span><br><span class="line"><span class="comment">##当前连接的客户端当中，最长的输出列表，用client list命令观察omem字段最大值</span></span><br><span class="line">client_longest_output_list:0</span><br><span class="line"><span class="comment">#当前连接的客户端当中，最大输入缓存，用client list命令观察qbuf和qbuf-free两个字段最大值</span></span><br><span class="line">client_biggest_input_buf:0</span><br><span class="line"><span class="comment">#正在等待阻塞命令(BLPOP、BRPOP、BRPOPLPUSH)的客户端的数量</span></span><br><span class="line">blocked_clients:0</span><br><span class="line"></span><br><span class="line"><span class="comment">#内存信息</span></span><br><span class="line"><span class="comment"># Memory</span></span><br><span class="line"><span class="comment">#由redis分配器分配的内存总量，以字节为单位</span></span><br><span class="line">used_memory:845336</span><br><span class="line"><span class="comment">#以人类可读的格式返回redis分配的内存总量</span></span><br><span class="line">used_memory_human:825.52K</span><br><span class="line"><span class="comment">#从操作系统的角度，返回redis已分配的内存总量(俗称常驻集大小)。这个值和top命令的输出一致</span></span><br><span class="line">used_memory_rss:1654784</span><br><span class="line"><span class="comment">#以人类可读方式，返回redis已分配的内存总量</span></span><br><span class="line">used_memory_rss_human:1.58M</span><br><span class="line"><span class="comment">#redis的内存消耗峰值(以字节为单位)</span></span><br><span class="line">used_memory_peak:845336</span><br><span class="line"><span class="comment">#以人类可读的格式返回redis的内存消耗峰值</span></span><br><span class="line">used_memory_peak_human:825.52K</span><br><span class="line"><span class="comment">#整个系统内存</span></span><br><span class="line">total_system_memory:1028517888</span><br><span class="line"><span class="comment">#以人类可读的格式，显示整个系统内存</span></span><br><span class="line">total_system_memory_human:980.87M</span><br><span class="line"><span class="comment">#Lua脚本存储占用的内存</span></span><br><span class="line">used_memory_lua:37888</span><br><span class="line"><span class="comment">#以人类可读的格式，显示Lua脚本存储占用的内存</span></span><br><span class="line">used_memory_lua_human:37.00K</span><br><span class="line"><span class="comment">#Redis实例的最大内存配置</span></span><br><span class="line">maxmemory:0</span><br><span class="line"><span class="comment">#以人类可读的格式，显示Redis实例的最大内存配置</span></span><br><span class="line">maxmemory_human:0B</span><br><span class="line"><span class="comment">#当达到maxmemory时的淘汰策略</span></span><br><span class="line">maxmemory_policy:noeviction</span><br><span class="line"><span class="comment">#内存分裂比例（used_memory_rss/ used_memory）</span></span><br><span class="line">mem_fragmentation_ratio:1.96</span><br><span class="line"><span class="comment">#内存分配器</span></span><br><span class="line">mem_allocator:jemalloc-4.0.3</span><br><span class="line"></span><br><span class="line"><span class="comment">#持久化信息</span></span><br><span class="line"><span class="comment"># Persistence</span></span><br><span class="line"><span class="comment">#服务器是否正在载入持久化文件</span></span><br><span class="line">loading:0</span><br><span class="line"><span class="comment">#离最近一次成功生成rdb文件，写入命令的个数，即有多少个写入命令没有持久化</span></span><br><span class="line">rdb_changes_since_last_save:131</span><br><span class="line"><span class="comment">#服务器是否正在创建rdb文件</span></span><br><span class="line">rdb_bgsave_in_progress:0</span><br><span class="line"><span class="comment">#最近一次rdb持久化保存时间</span></span><br><span class="line">rdb_last_save_time:1540009420</span><br><span class="line"><span class="comment">#最近一次rdb持久化是否成功</span></span><br><span class="line">rdb_last_bgsave_status:ok</span><br><span class="line"><span class="comment">#最近一次成功生成rdb文件耗时秒数</span></span><br><span class="line">rdb_last_bgsave_time_sec:-1</span><br><span class="line"><span class="comment">#如果服务器正在创建rdb文件，那么这个域记录的就是当前的创建操作已经耗费的秒数</span></span><br><span class="line">rdb_current_bgsave_time_sec:-1</span><br><span class="line"><span class="comment">#是否开启了aof</span></span><br><span class="line">aof_enabled:0</span><br><span class="line"><span class="comment">#标识aof的rewrite操作是否在进行中</span></span><br><span class="line">aof_rewrite_in_progress:0</span><br><span class="line"><span class="comment">#rewrite任务计划，当客户端发送bgrewriteaof指令，如果当前rewrite子进程正在执行，那么将客户端请求的bgrewriteaof变为计划任务，待aof子进程结束后执行rewrite</span></span><br><span class="line">aof_rewrite_scheduled:0</span><br><span class="line"><span class="comment">#最近一次aof rewrite耗费的时长</span></span><br><span class="line">aof_last_rewrite_time_sec:-1</span><br><span class="line"><span class="comment">#如果rewrite操作正在进行，则记录所使用的时间，单位秒</span></span><br><span class="line">aof_current_rewrite_time_sec:-1</span><br><span class="line"><span class="comment">#上次bgrewriteaof操作的状态</span></span><br><span class="line">aof_last_bgrewrite_status:ok</span><br><span class="line"><span class="comment">#上次aof写入状态</span></span><br><span class="line">aof_last_write_status:ok</span><br><span class="line"></span><br><span class="line"><span class="comment">#统计信息</span></span><br><span class="line"><span class="comment"># Stats</span></span><br><span class="line"><span class="comment">#新创建连接个数,如果新创建连接过多，过度地创建和销毁连接对性能有影响，说明短连接严重或连接池使用有问题，需调研代码的连接设置</span></span><br><span class="line">total_connections_received:19</span><br><span class="line"><span class="comment">#redis处理的命令数</span></span><br><span class="line">total_commands_processed:299</span><br><span class="line"><span class="comment">#redis当前的qps，redis内部较实时的每秒执行的命令数</span></span><br><span class="line">instantaneous_ops_per_sec:0</span><br><span class="line"><span class="comment">#redis网络入口流量字节数</span></span><br><span class="line">total_net_input_bytes:10773</span><br><span class="line"><span class="comment">#redis网络出口流量字节数</span></span><br><span class="line">total_net_output_bytes:97146</span><br><span class="line"><span class="comment">#redis网络入口kps</span></span><br><span class="line">instantaneous_input_kbps:0.00</span><br><span class="line"><span class="comment">#redis网络出口kps</span></span><br><span class="line">instantaneous_output_kbps:0.00</span><br><span class="line"><span class="comment">#拒绝的连接个数，redis连接个数达到maxclients限制，拒绝新连接的个数</span></span><br><span class="line">rejected_connections:0</span><br><span class="line"><span class="comment">#主从完全同步次数</span></span><br><span class="line">sync_full:0</span><br><span class="line"><span class="comment">#主从完全同步成功次数</span></span><br><span class="line">sync_partial_ok:0</span><br><span class="line"><span class="comment">#主从完全同步失败次数</span></span><br><span class="line">sync_partial_err:0</span><br><span class="line"><span class="comment">#运行以来过期的key的数量</span></span><br><span class="line">expired_keys:5</span><br><span class="line"><span class="comment">#过期的比率</span></span><br><span class="line">evicted_keys:0</span><br><span class="line"><span class="comment">#命中次数</span></span><br><span class="line">keyspace_hits:85</span><br><span class="line"><span class="comment">#没命中次数</span></span><br><span class="line">keyspace_misses:17</span><br><span class="line"><span class="comment">#当前使用中的频道数量</span></span><br><span class="line">pubsub_channels:0</span><br><span class="line"><span class="comment">#当前使用的模式的数量</span></span><br><span class="line">pubsub_patterns:0</span><br><span class="line"><span class="comment">#最近一次fork操作阻塞redis进程的耗时数，单位微秒</span></span><br><span class="line">latest_fork_usec:0</span><br><span class="line"><span class="comment">#是否已经缓存了到该地址的连接</span></span><br><span class="line">migrate_cached_sockets:0</span><br><span class="line"></span><br><span class="line"><span class="comment">#主从复制信息</span></span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line"><span class="comment">#角色主库</span></span><br><span class="line">role:master</span><br><span class="line"><span class="comment">#连接slave的个数</span></span><br><span class="line">connected_slaves:0</span><br><span class="line"><span class="comment">#主从同步偏移量,此值如果和上面的offset相同说明主从一致没延迟，与master_replid可被用来标识主实例复制流中的位置</span></span><br><span class="line">master_repl_offset:0</span><br><span class="line"><span class="comment">#复制积压缓冲区是否开启</span></span><br><span class="line">repl_backlog_active:0</span><br><span class="line"><span class="comment">#复制积压缓冲大小</span></span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line"><span class="comment">#复制缓冲区里偏移量的大小</span></span><br><span class="line">repl_backlog_first_byte_offset:0</span><br><span class="line"><span class="comment">#此值等于 master_repl_offset - repl_backlog_first_byte_offset,该值不会超过repl_backlog_size的大小</span></span><br><span class="line">repl_backlog_histlen:0</span><br><span class="line"></span><br><span class="line"><span class="comment">#CPU信息</span></span><br><span class="line"><span class="comment"># CPU</span></span><br><span class="line"><span class="comment">#将所有redis主进程在内核态所占用的CPU时求和累计起来</span></span><br><span class="line">used_cpu_sys:203.44</span><br><span class="line"><span class="comment">#将所有redis主进程在用户态所占用的CPU时求和累计起来</span></span><br><span class="line">used_cpu_user:114.57</span><br><span class="line"><span class="comment">#将后台进程在内核态所占用的CPU时求和累计起来</span></span><br><span class="line">used_cpu_sys_children:0.00</span><br><span class="line"><span class="comment">#将后台进程在用户态所占用的CPU时求和累计起来</span></span><br><span class="line">used_cpu_user_children:0.00</span><br><span class="line"></span><br><span class="line"><span class="comment">#集群信息</span></span><br><span class="line"><span class="comment"># Cluster</span></span><br><span class="line"><span class="comment">#实例是否启用集群模式</span></span><br><span class="line">cluster_enabled:0</span><br><span class="line"></span><br><span class="line"><span class="comment">#库相关统计信息</span></span><br><span class="line"><span class="comment"># Keyspace</span></span><br><span class="line"><span class="comment">#db0的key的数量,以及带有生存期的key的数,平均存活时间</span></span><br><span class="line">db0:keys=17,expires=0,avg_ttl=0</span><br><span class="line"></span><br><span class="line"><span class="comment">#单独查看某一个信息（例：查看CPU信息）</span></span><br><span class="line">127.0.0.1:6379&gt; info cpu</span><br><span class="line"><span class="comment"># CPU</span></span><br><span class="line">used_cpu_sys:203.45</span><br><span class="line">used_cpu_user:114.58</span><br><span class="line">used_cpu_sys_children:0.00</span><br><span class="line">used_cpu_user_children:0.00</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#面试问题：公司服务器的架构 日PV(访问量,一个用户产生的请求)多少  按IP算是(UV,真实用户)</span></span><br></pre></td></tr></table></figure>
<h2 id="14-Hugo-github搭建博客"><a href="#14-Hugo-github搭建博客" class="headerlink" title="14 Hugo+github搭建博客"></a>14 Hugo+github搭建博客</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1、环境与工具准备</span><br><span class="line">本教程主要面对的是Windows用户</span><br><span class="line"></span><br><span class="line">操作系统：Windows10</span><br><span class="line">         GitHub 帐号</span><br><span class="line">         Git</span><br><span class="line">         Node</span><br><span class="line">         Hexo</span><br><span class="line">         文本编辑器(强烈推荐VSCODE)</span><br><span class="line">         一个域名（强烈推荐买个域名）</span><br><span class="line">         云服务器（可选）</span><br></pre></td></tr></table></figure>
<p>1、Github注册与创建仓库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1、进入官网：https://github.com/</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915140804270.png" alt="image-20240915140804270"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915141320902.png" alt="image-20240915141320902"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">邮箱：2659019085@qq.com</span><br><span class="line">密码：asm213641</span><br><span class="line">用户名：aurora766</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2、点击右上角创建仓库，创建一个`&lt;用户名&gt;.github.io`的仓库。</span><br><span class="line"><span class="comment">#仓库的格式必须为：&lt;用户名&gt;.github.io (注意：前缀必须为用户名，不要等后面404了再来为什么！！！)</span></span><br><span class="line"></span><br><span class="line">3、Description：为描述仓库（选填）</span><br><span class="line"></span><br><span class="line">4、勾选 Initialize this repository with a README 初始化一个 README.md 文件</span><br><span class="line"></span><br><span class="line">5、点击 Creat repository 进行创建</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915141830446.png" alt="image-20240915141830446"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915144412877.png" alt="image-20240915144412877"></p>
<p>2、Git安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1、进入官网：https://git-scm.com/downloads ，由于官网下载太慢可以通过淘宝的开源镜像下载 网址：https://registry.npmmirror.com/binary.html?path=git-for-windows/v2.36.1.windows.1/ ，下载版本更具自己的需求选择即可。</span><br><span class="line"></span><br><span class="line">2、下载后傻瓜式安装Git即可，安装的目录可以使用默认目录【C:/Program Files/Git】，也可以自定义路径。  安装的时候就默认一直点击下一步就行</span><br><span class="line"></span><br><span class="line">3、点击电脑左下角开始即可看见Git Bash。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Git CMD 是windows 命令行的指令风格</span><br><span class="line">Git Bash 是linux系统的指令风格（建议使用）</span><br><span class="line">Git GUI是图形化界面（新手学习不建议使用）</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240914212356457.png" alt="image-20240914212356457"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240914212518092.png" alt="image-20240914212518092"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">4、常用命令</span><br><span class="line">git config -l                <span class="comment">#查看所有配置</span></span><br><span class="line">git config --system --list   <span class="comment">#查看系统配置</span></span><br><span class="line">git config --global --list   <span class="comment">#查看用户（全局）配置</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5、配置用户名和邮箱</span><br><span class="line">git config --global user.name <span class="string">&quot;你的用户名&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;你的邮箱&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">git config --global user.name <span class="string">&quot;aurora766&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;2659019085@qq.com&quot;</span></span><br><span class="line"></span><br><span class="line">6、通过git config -l 检查是否配置成功，至此git安装及配置全部完成。</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915145119712.png" alt="image-20240915145119712"></p>
<p>3、Node安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1、打开Node官网，下载和自己系统相配的Node的安装程序，否则会出现安装问题。下载地址：https://nodejs.org/en/download/</span><br><span class="line">我个人的版本是 v18.20.4，按照个人经验，可以选个低一些的版本，可以和我的一样，否则后面会出现各种不兼容的问题！我之前就是安装16的，系统无法识别，如果大家遇到问题建议选个低版本的！历史版本下载页面：https://nodejs.org/en/download/releases/</span><br><span class="line"></span><br><span class="line">2、下载后安装，安装的目录可以使用默认目录【C:/Program Files/nodejs/】，也可以自定义路径。</span><br><span class="line">这个环境路径切换坑也很多，如果大家C盘空间足够可以直接装C盘，如果想切换其他盘或者把环境遍历切换到自定义路径也可以，具体教程百度(不过坑比较多就是了)!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3、安装完成后，检查是否安装成功。在键盘按下win + R键，输入CMD，然后回车，打开CMD窗口，执行node -v命令，看到版本信息，则说明安装成功。</span><br><span class="line"></span><br><span class="line">4、修改npm源。npm下载各种模块，默认是从国处服务器下载，速度较慢，建议配置成淘宝镜像。打开CMD窗口，运行如下命令:</span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmmirror.com/</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240914220942969.png" alt="image-20240914220942969"></p>
<p>4、安装Hexo</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、在Git BASH输入如下命令安装</span><br><span class="line">npm install -g hexo-cli</span><br><span class="line"></span><br><span class="line">2、安装完后输入hexo -v验证是否安装成功。</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240914221041050.png" alt="image-20240914221041050"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#报错解决</span></span><br><span class="line">$ npm install -g hexo-cli</span><br><span class="line">npm error code CERT_HAS_EXPIRED</span><br><span class="line">npm error errno CERT_HAS_EXPIRED</span><br><span class="line">npm error request to https://registry.npm.taobao.org/hexo-cli failed, reason: certificate has expired</span><br><span class="line"></span><br><span class="line">npm error A complete <span class="built_in">log</span> of this run can be found <span class="keyword">in</span>: C:\Users\Mac\AppData\Local\npm-cache\_logs\2024-09-14T13_52_56_453Z-debug-0.log</span><br><span class="line"></span><br><span class="line">1.关闭 npm 的 SSL 验证</span><br><span class="line"> npm config <span class="built_in">set</span> strict-ssl <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">2.清除 npm 缓存</span><br><span class="line"> npm cache cean --force</span><br></pre></td></tr></table></figure>
<p>5、连接至Github</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1、在git bash执行命令生成ssh公钥，此公钥用于你的计算机连接Github，执行命令之后按4个回车</span><br><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;你的邮箱&quot;</span></span><br><span class="line"></span><br><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;2659019085@qq.com&quot;</span></span><br><span class="line"></span><br><span class="line">2、之后打开C盘下用户文件夹下的.ssh的文件夹，会看到 id_rsa.pub</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915150352820.png" alt="image-20240915150352820"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3、用记事本打开上述图片中的公钥（id_rsa.pub），复制里面的全部内容，然后开始在github中配置ssh密钥。</span><br><span class="line"></span><br><span class="line">4、将 SSH KEY 配置到 GitHub</span><br><span class="line">进入github，点击右上角头像 选择settings，进入设置页后选择 SSH and GPG keys，名字随便起，公钥填到Key那一栏。</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915150708021.png" alt="image-20240915150708021"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915151004537.png" alt="image-20240915151004537"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">5、测试连接，输入以下命令</span><br><span class="line">ssh -T git@github.com</span><br><span class="line"></span><br><span class="line">出现连接到账户的信息，说明已经大功告成，至此完成了环境准备工作。</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915151343104.png" alt="image-20240915151343104"></p>
<p>6、初始化 Hexo 项目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1、打开cmd命令窗口，执行hexo init初始化项目。</span><br><span class="line">hexo init blog-demo</span><br><span class="line"></span><br><span class="line">blog-demo为项目名</span><br><span class="line"></span><br><span class="line">2、进入blog-demo ，输入npm i安装相关依赖。</span><br><span class="line"><span class="built_in">cd</span> blog-demo </span><br><span class="line">npm i</span><br><span class="line"></span><br><span class="line">3、输入hexo server或者hexo s 启动项目</span><br><span class="line"></span><br><span class="line">4、打开浏览器，输入地址：http://localhost:4000/ ，看到下面的效果，说明你的博客已经构建成功了。</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915152540188.png" alt="image-20240915152540188"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">初始化项目后，blog-demo有如下结构：</span><br><span class="line"></span><br><span class="line">image-20221027113438707</span><br><span class="line">【node_modules】：依赖包</span><br><span class="line">【scaffolds】：生成文章的一些模板</span><br><span class="line">【<span class="built_in">source</span>】：用来存放你的文章</span><br><span class="line">【themes】：主题</span><br><span class="line">【.npmignore】：发布时忽略的文件（可忽略）</span><br><span class="line">【_config.landscape.yml】：主题的配置文件</span><br><span class="line">【config.yml】：博客的配置文件</span><br><span class="line">【package.json】：项目名称、描述、版本、运行和开发等信息</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915153639627.png" alt="image-20240915153639627"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915152744328.png" alt="image-20240915152744328"></p>
<p>7、将静态博客挂载到 GitHub Pages</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1、在git bash运行如下命令，安装 hexo-deployer-git</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"></span><br><span class="line">2、修改 _config.yml 文件</span><br><span class="line">在blog-demo目录下的_config.yml，就是整个Hexo框架的配置文件了。可以在里面修改大部分的配置。详细可参考官方的配置描述。</span><br><span class="line">修改最后一行的配置，将repository修改为你自己的github项目地址即可，还有分支要改为main代表主分支（注意缩进）。</span><br><span class="line"></span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repository: git@github.com:aurora766/aurora766.github.io.git</span><br><span class="line">  branch: main</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\Mac\AppData\Roaming\Typora\typora-user-images\image-20240915154159783.png" alt="image-20240915154159783"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">3、修改好配置后，运行如下命令，将代码部署到 GitHub（Hexo三连）。</span><br><span class="line">hexo clean &amp;&amp; hexo generate &amp;&amp; hexo deploy    <span class="comment">#Git BASH终端执行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hexo clean：    <span class="comment">#删除之前生成的文件，若未生成过静态文件，可忽略此命令。</span></span><br><span class="line">hexo generate： <span class="comment">#生成静态文章，可以用hexo g缩写</span></span><br><span class="line">hexo deploy：   <span class="comment">#部署文章，可以用hexo d缩写</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#注意：deploy时可能要你输入 username 和 password。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>redis</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://www.fomal.cc/posts/7b25d017.html">https://www.fomal.cc/posts/7b25d017.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>Fomalhaut🥝</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2024-09-15</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2024-09-15</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">投喂作者</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://tuchuang.voooe.cn/images/2023/01/04/2.webp" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2023/01/04/2.webp" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://tuchuang.voooe.cn/images/2023/01/04/20f8e49805975b8f8.webp" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tuchuang.voooe.cn/images/2023/01/04/20f8e49805975b8f8.webp" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/posts/2013454d.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Markdown语法与外挂标签写法汇总</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:bold">目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%BC%96%E5%86%99%E5%AF%86%E9%92%A5%E5%88%86%E5%8F%91%E5%85%8D%E4%BA%A4%E4%BA%92%E7%9A%84%E8%84%9A%E6%9C%AC"><span class="toc-text">1. 编写密钥分发免交互的脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%B7%B3%E6%9D%BF%E6%9C%BA%E8%84%9A%E6%9C%AC"><span class="toc-text">2. 跳板机脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5"><span class="toc-text">3. 时间同步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E6%90%AD%E5%BB%BANginx-Tomcat%E6%90%AD%E5%BB%BAJpress"><span class="toc-text">4、搭建Nginx+Tomcat搭建Jpress</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-zabbix%E7%9B%91%E6%8E%A7%EF%BC%8C%E7%9B%91%E6%8E%A7%E4%B8%80%E5%8F%B0%E6%9C%BA%E5%99%A8"><span class="toc-text">5. zabbix监控，监控一台机器</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%8B%E9%9D%A2%E8%BF%99%E6%AE%B5%E4%B8%8D%E7%94%A8%E7%AE%A1%EF%BC%8C%E5%86%99roles%E5%8F%AF%E4%BB%A5%E5%8F%82%E8%80%83%E4%B8%8B%E9%9D%A2%E8%BF%99%E4%B8%AA%E6%96%B9%E6%B3%95%E6%AD%A5%E9%AA%A4%EF%BC%8C%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%97%B6%E5%80%99%E4%B8%8D%E7%94%A8%E8%BE%93%E5%AF%86%E7%A0%81%EF%BC%8C%E5%85%88%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E5%86%8D%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-text">######下面这段不用管，写roles可以参考下面这个方法步骤，导入数据库的时候不用输密码，先导入数据库，再创建用户</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Git-%E6%9E%84%E5%BB%BA%E5%88%86%E5%B8%83%E5%BC%8F%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F"><span class="toc-text">6. Git 构建分布式版本控制系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%90%AD%E5%BB%BA%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E5%BC%95%E6%93%8EJenkins"><span class="toc-text">7. 搭建持续集成引擎Jenkins</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-jumpserver%E9%83%A8%E7%BD%B2"><span class="toc-text">9 . jumpserver部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E9%83%A8%E7%BD%B2ELK"><span class="toc-text">10. 部署ELK</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11"><span class="toc-text">11.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E9%9C%80%E8%A6%81%E8%87%AA%E5%B7%B1%E8%B0%83%E7%A0%94"><span class="toc-text">12  需要自己调研</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-redis%E7%9A%84info%E8%8E%B7%E5%8F%96%E4%BF%A1%E6%81%AF"><span class="toc-text">13.redis的info获取信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-Hugo-github%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2"><span class="toc-text">14 Hugo+github搭建博客</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">格言🧬</p><div class="bg-ad"><div>再看看那个光点，它就在这里，这是家园，这是我们 —— 你所爱的每一个人，你认识的一个人，你听说过的每一个人，曾经有过的每一个人，都在它上面度过他们的一生✨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">点击开启星辰之旅</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">猜你想看💡</p><ul class="ft-links"><li><a href="/posts/eec9786.html">魔改指南</a><a href="/box/nav/">网址导航</a></li><li><a href="/social/link/">我的朋友</a><a href="/comments/">留点什么</a></li><li><a href="/personal/about/">关于作者</a><a href="/archives/">文章归档</a></li><li><a href="/categories/">文章分类</a><a href="/tags/">文章标签</a></li><li><a href="/box/Gallery/">我的画廊</a><a href="/personal/bb/">我的唠叨</a></li><li><a href="/site/time/">建设进程</a><a href="/site/census/">网站统计</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">推荐友链⌛</p><div class="ft-img-group"><div class="img-group-item"><a href="https://www.fomal.cc/" title="Fomalhaut🥝"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/60e5d4e39da7c077.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2024</b></span><span><b>&nbsp;&nbsp;By Fomalhaut🥝</b></span></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v6.3.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v4.3.1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用多线部署，主线路托管于Vercel"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="本站数据分析得益于51la技术支持"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20226665" style="margin-inline:5px" title="本站已加入萌ICP豪华套餐，萌ICP备20226665号"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/萌ICP备-20226665-fe1384.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="本网站经Service Worker分流至缤纷云对象存储"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-缤纷云-9c62da.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="本站使用网盾星球提供CDN加速与防护"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-网盾星球-fff2cc.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本网站源码由Github提供存储仓库"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""/></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="右键模式" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="分享链接" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>百度搜索</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>转到链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>空降评论</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>复制本文地址</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>转到链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>在新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>昼夜切换</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>关于博客</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>美化设置</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>切换全屏</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>打印页面</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: '',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: '',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_3586335_hsivh70x0fm.js"></script><script async src="//at.alicdn.com/t/c/font_3636804_gr02jmjr3y9.js"></script><script async src="//at.alicdn.com/t/c/font_3612150_kfv55xn3u2g.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://www.fomal.cc/categories/演示/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍥 小Fの案例演示笔记 (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="https://www.fomal.cc/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(33.333333333333336% - 5px);background: #e9e9e9;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://source.fomal.cc/img/default_cover_14.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">Markdown语法与外挂标签写法汇总</a><div class="blog-slider__text">🥧本文汇总Markdown格式以及外挂标签在网页端的渲染效果，可作为文档进行查询</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/site/census/'|| '/site/census/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("/api?null",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'null')
    }
  </script><!-- hexo injector body_end end --></body></html>